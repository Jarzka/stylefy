{
"version":3,
"file":"goog.uri.uri.js",
"lineCount":919,
"mappings":"AAgCAA,IAAAC,QAAA,CAAa,UAAb,CAAA;AACAD,IAAAC,QAAA,CAAa,oBAAb,CAAA;AAEAD,IAAAE,QAAA,CAAa,YAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,cAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,aAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,cAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,kBAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,gBAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,+BAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,mCAAb,CAAA;AAkCA;;;;;;AAAAF,IAAAG,IAAA,GAAWC,QAAQ,CAACC,OAAD,EAAUC,cAAV,CAA0B;AAK3C,iCAAA,IAAAC,QAAA,GAAe,EAAf;AAMA,iCAAA,IAAAC,UAAA,GAAiB,EAAjB;AAMA,iCAAA,IAAAC,QAAA,GAAe,EAAf;AAMA,kCAAA,IAAAC,MAAA,GAAa,IAAb;AAMA,iCAAA,IAAAC,MAAA,GAAa,EAAb;AAMA,iCAAA,IAAAC,UAAA,GAAiB,EAAjB;AAMA,kCAAA,IAAAC,YAAA,GAAmB,KAAnB;AAMA,kCAAA,IAAAC,YAAA,GAAmB,KAAnB;AAMA,8CAAA,IAAAC,WAAA;AAGA,MAAIC,CAAJ;AACA,MAAIX,OAAJ,YAAuBL,IAAAG,IAAvB,CAAiC;AAC/B,QAAAW,YAAA,GAAoBR,cAAD,KAAoBW,SAApB,GAAiCX,cAAjC,GACiCD,OAAAa,cAAA,EADpD;AAEA,QAAAC,UAAA,CAAed,OAAAe,UAAA,EAAf,CAAA;AACA,QAAAC,YAAA,CAAiBhB,OAAAiB,YAAA,EAAjB,CAAA;AACA,QAAAC,UAAA,CAAelB,OAAAmB,UAAA,EAAf,CAAA;AACA,QAAAC,QAAA,CAAapB,OAAAqB,QAAA,EAAb,CAAA;AACA,QAAAC,QAAA,CAAatB,OAAAuB,QAAA,EAAb,CAAA;AACA,QAAAC,aAAA,CAAkBxB,OAAAyB,aAAA,EAAAC,MAAA,EAAlB,CAAA;AACA,QAAAC,YAAA,CAAiB3B,OAAA4B,YAAA,EAAjB,CAAA;AAT+B,GAAjC;AAUO,QAAI5B,OAAJ,KAAgBW,CAAhB,GAAoBhB,IAAAkC,IAAAC,MAAAC,MAAA,CAAqBC,MAAA,CAAOhC,OAAP,CAArB,CAApB,EAA4D;AACjE,UAAAS,YAAA,GAAmB,CAAC,CAACR,cAArB;AAKA,UAAAa,UAAA,CAAeH,CAAA,CAAEhB,IAAAkC,IAAAC,MAAAG,eAAAC,OAAF,CAAf,IAA0D,EAA1D,EAA8D,IAA9D,CAAA;AACA,UAAAlB,YAAA,CAAiBL,CAAA,CAAEhB,IAAAkC,IAAAC,MAAAG,eAAAE,UAAF,CAAjB,IAA+D,EAA/D,EAAmE,IAAnE,CAAA;AACA,UAAAjB,UAAA,CAAeP,CAAA,CAAEhB,IAAAkC,IAAAC,MAAAG,eAAAG,OAAF,CAAf,IAA0D,EAA1D,EAA8D,IAA9D,CAAA;AACA,UAAAhB,QAAA,CAAaT,CAAA,CAAEhB,IAAAkC,IAAAC,MAAAG,eAAAI,KAAF,CAAb,CAAA;AACA,UAAAf,QAAA,CAAaX,CAAA,CAAEhB,IAAAkC,IAAAC,MAAAG,eAAAK,KAAF,CAAb,IAAsD,EAAtD,EAA0D,IAA1D,CAAA;AACA,UAAAd,aAAA,CAAkBb,CAAA,CAAEhB,IAAAkC,IAAAC,MAAAG,eAAAM,WAAF,CAAlB,IAAiE,EAAjE,EAAqE,IAArE,CAAA;AACA,UAAAZ,YAAA,CAAiBhB,CAAA,CAAEhB,IAAAkC,IAAAC,MAAAG,eAAAO,SAAF,CAAjB,IAA8D,EAA9D,EAAkE,IAAlE,CAAA;AAZiE,KAA5D,KAcA;AACL,UAAA/B,YAAA,GAAmB,CAAC,CAACR,cAArB;AACA,UAAAS,WAAA,GAAkB,IAAIf,IAAAG,IAAA2C,UAAJ,CAAuB,IAAvB,EAA6B,IAA7B,EAAmC,IAAAhC,YAAnC,CAAlB;AAFK;AAxBP;AAzD2C,CAA7C;AA4FA,sBAAAd,IAAAG,IAAA4C,aAAA,GAAwB/C,IAAAkC,IAAAC,MAAAa,mBAAAC,OAAxB;AAOA;;;;AAAAjD,IAAAG,IAAA+C,UAAAC,SAAA,GAA8BC,QAAQ,EAAG;AACvC,MAAIC,MAAM,EAAV;AAEA,MAAIC,SAAS,IAAAlC,UAAA,EAAb;AACA,MAAIkC,MAAJ;AACED,OAAAE,KAAA,CACIvD,IAAAG,IAAAqD,oBAAA,CACIF,MADJ,EACYtD,IAAAG,IAAAsD,gCADZ,EACsD,IADtD,CADJ,EAGI,GAHJ,CAAA;AADF;AAOA,MAAIC,SAAS,IAAAlC,UAAA,EAAb;AACA,MAAIkC,MAAJ,IAAcJ,MAAd,IAAwB,MAAxB,CAAgC;AAC9BD,OAAAE,KAAA,CAAS,IAAT,CAAA;AAEA,QAAII,WAAW,IAAArC,YAAA,EAAf;AACA,QAAIqC,QAAJ;AACEN,SAAAE,KAAA,CACIvD,IAAAG,IAAAqD,oBAAA,CACIG,QADJ,EACc3D,IAAAG,IAAAsD,gCADd,EACwD,IADxD,CADJ,EAGI,GAHJ,CAAA;AADF;AAOAJ,OAAAE,KAAA,CAASvD,IAAAG,IAAAyD,sBAAA,CAA+B5D,IAAA6D,OAAAC,UAAA,CAAsBJ,MAAtB,CAA/B,CAAT,CAAA;AAEA,QAAIK,OAAO,IAAArC,QAAA,EAAX;AACA,QAAIqC,IAAJ,IAAY,IAAZ;AACEV,SAAAE,KAAA,CAAS,GAAT,EAAclB,MAAA,CAAO0B,IAAP,CAAd,CAAA;AADF;AAd8B;AAmBhC,MAAIC,OAAO,IAAApC,QAAA,EAAX;AACA,MAAIoC,IAAJ,CAAU;AACR,QAAI,IAAAC,UAAA,EAAJ,IAAwBD,IAAAE,OAAA,CAAY,CAAZ,CAAxB,IAA0C,GAA1C;AACEb,SAAAE,KAAA,CAAS,GAAT,CAAA;AADF;AAGAF,OAAAE,KAAA,CACIvD,IAAAG,IAAAqD,oBAAA,CACIQ,IADJ,EACUA,IAAAE,OAAA,CAAY,CAAZ,CAAA,IAAkB,GAAlB,GAAwBlE,IAAAG,IAAAgE,4BAAxB,GACwBnE,IAAAG,IAAAiE,4BAFlC,EAGI,IAHJ,CADJ,CAAA;AAJQ;AAWV,MAAIC,QAAQ,IAAAC,gBAAA,EAAZ;AACA,MAAID,KAAJ;AACEhB,OAAAE,KAAA,CAAS,GAAT,EAAcc,KAAd,CAAA;AADF;AAIA,MAAIE,WAAW,IAAAtC,YAAA,EAAf;AACA,MAAIsC,QAAJ;AACElB,OAAAE,KAAA,CACI,GADJ,EACSvD,IAAAG,IAAAqD,oBAAA,CACIe,QADJ,EACcvE,IAAAG,IAAAqE,wBADd,CADT,CAAA;AADF;AAKA,SAAOnB,GAAAoB,KAAA,CAAS,EAAT,CAAP;AAtDuC,CAAzC;AA2EA;;;;AAAAzE,IAAAG,IAAA+C,UAAAwB,QAAA,GAA6BC,QAAQ,CAACC,WAAD,CAAc;AAEjD,MAAIC,cAAc,IAAA9C,MAAA,EAAlB;AAKA,MAAI+C,aAAaF,WAAAG,UAAA,EAAjB;AAEA,MAAID,UAAJ;AACED,eAAA1D,UAAA,CAAsByD,WAAAxD,UAAA,EAAtB,CAAA;AADF;AAGE0D,cAAA,GAAaF,WAAAI,YAAA,EAAb;AAHF;AAMA,MAAIF,UAAJ;AACED,eAAAxD,YAAA,CAAwBuD,WAAAtD,YAAA,EAAxB,CAAA;AADF;AAGEwD,cAAA,GAAaF,WAAAX,UAAA,EAAb;AAHF;AAMA,MAAIa,UAAJ;AACED,eAAAtD,UAAA,CAAsBqD,WAAApD,UAAA,EAAtB,CAAA;AADF;AAGEsD,cAAA,GAAaF,WAAAK,QAAA,EAAb;AAHF;AAMA,MAAIjB,OAAOY,WAAAhD,QAAA,EAAX;AACA,MAAIkD,UAAJ;AACED,eAAApD,QAAA,CAAoBmD,WAAAlD,QAAA,EAApB,CAAA;AADF,QAEO;AACLoD,cAAA,GAAaF,WAAAM,QAAA,EAAb;AACA,QAAIJ,UAAJ,CAAgB;AAEd,UAAId,IAAAE,OAAA,CAAY,CAAZ,CAAJ,IAAsB,GAAtB;AAEE,YAAI,IAAAD,UAAA,EAAJ,IAAwB,CAAC,IAAAiB,QAAA,EAAzB;AAEElB,cAAA,GAAO,GAAP,GAAaA,IAAb;AAFF,cAGO;AAEL,cAAImB,iBAAiBN,WAAAjD,QAAA,EAAAwD,YAAA,CAAkC,GAAlC,CAArB;AACA,cAAID,cAAJ,IAAsB,EAAtB;AACEnB,gBAAA,GAAOa,WAAAjD,QAAA,EAAAyD,OAAA,CAA6B,CAA7B,EAAgCF,cAAhC,GAAiD,CAAjD,CAAP,GAA6DnB,IAA7D;AADF;AAHK;AALT;AAaAA,UAAA,GAAOhE,IAAAG,IAAAmF,kBAAA,CAA2BtB,IAA3B,CAAP;AAfc;AAFX;AAqBP,MAAIc,UAAJ;AACED,eAAAlD,QAAA,CAAoBqC,IAApB,CAAA;AADF;AAGEc,cAAA,GAAaF,WAAAW,SAAA,EAAb;AAHF;AAMA,MAAIT,UAAJ;AACED,eAAAhD,aAAA,CAAyB+C,WAAA9C,aAAA,EAAAC,MAAA,EAAzB,CAAA;AADF;AAGE+C,cAAA,GAAaF,WAAAY,YAAA,EAAb;AAHF;AAMA,MAAIV,UAAJ;AACED,eAAA7C,YAAA,CAAwB4C,WAAA3C,YAAA,EAAxB,CAAA;AADF;AAIA,SAAO4C,WAAP;AAnEiD,CAAnD;AA2EA;;;AAAA7E,IAAAG,IAAA+C,UAAAnB,MAAA,GAA2B0D,QAAQ,EAAG;AACpC,SAAO,IAAIzF,IAAAG,IAAJ,CAAa,IAAb,CAAP;AADoC,CAAtC;AAQA;;;AAAAH,IAAAG,IAAA+C,UAAA9B,UAAA,GAA+BsE,QAAQ,EAAG;AACxC,SAAO,IAAAnF,QAAP;AADwC,CAA1C;AAaA;;;;;AAAAP,IAAAG,IAAA+C,UAAA/B,UAAA,GAA+BwE,QAAQ,CAACC,SAAD,EAAYC,UAAZ,CAAwB;AAC7D,MAAAC,gBAAA,EAAA;AACA,MAAAvF,QAAA,GACIsF,UAAA,GAAa7F,IAAAG,IAAA4F,eAAA,CAAwBH,SAAxB,EAAmC,IAAnC,CAAb,GAAwDA,SAD5D;AAKA,MAAI,IAAArF,QAAJ;AACE,QAAAA,QAAA,GAAe,IAAAA,QAAAyF,QAAA,CAAqB,IAArB,EAA2B,EAA3B,CAAf;AADF;AAGA,SAAO,IAAP;AAV6D,CAA/D;AAiBA;;;AAAAhG,IAAAG,IAAA+C,UAAA6B,UAAA,GAA+BkB,QAAQ,EAAG;AACxC,SAAO,CAAC,CAAC,IAAA1F,QAAT;AADwC,CAA1C;AAQA;;;AAAAP,IAAAG,IAAA+C,UAAA5B,YAAA,GAAiC4E,QAAQ,EAAG;AAC1C,SAAO,IAAA1F,UAAP;AAD0C,CAA5C;AAaA;;;;;AAAAR,IAAAG,IAAA+C,UAAA7B,YAAA,GAAiC8E,QAAQ,CAACC,WAAD,EAAcP,UAAd,CAA0B;AACjE,MAAAC,gBAAA,EAAA;AACA,MAAAtF,UAAA,GACIqF,UAAA,GAAa7F,IAAAG,IAAA4F,eAAA,CAAwBK,WAAxB,CAAb,GAAoDA,WADxD;AAEA,SAAO,IAAP;AAJiE,CAAnE;AAWA;;;AAAApG,IAAAG,IAAA+C,UAAA8B,YAAA,GAAiCqB,QAAQ,EAAG;AAC1C,SAAO,CAAC,CAAC,IAAA7F,UAAT;AAD0C,CAA5C;AAQA;;;AAAAR,IAAAG,IAAA+C,UAAA1B,UAAA,GAA+B8E,QAAQ,EAAG;AACxC,SAAO,IAAA7F,QAAP;AADwC,CAA1C;AAaA;;;;;AAAAT,IAAAG,IAAA+C,UAAA3B,UAAA,GAA+BgF,QAAQ,CAACC,SAAD,EAAYX,UAAZ,CAAwB;AAC7D,MAAAC,gBAAA,EAAA;AACA,MAAArF,QAAA,GACIoF,UAAA,GAAa7F,IAAAG,IAAA4F,eAAA,CAAwBS,SAAxB,EAAmC,IAAnC,CAAb,GAAwDA,SAD5D;AAEA,SAAO,IAAP;AAJ6D,CAA/D;AAWA;;;AAAAxG,IAAAG,IAAA+C,UAAAe,UAAA,GAA+BwC,QAAQ,EAAG;AACxC,SAAO,CAAC,CAAC,IAAAhG,QAAT;AADwC,CAA1C;AAQA;;;AAAAT,IAAAG,IAAA+C,UAAAxB,QAAA,GAA6BgF,QAAQ,EAAG;AACtC,SAAO,IAAAhG,MAAP;AADsC,CAAxC;AAUA;;;;AAAAV,IAAAG,IAAA+C,UAAAzB,QAAA,GAA6BkF,QAAQ,CAACC,OAAD,CAAU;AAC7C,MAAAd,gBAAA,EAAA;AAEA,MAAIc,OAAJ,CAAa;AACXA,WAAA,GAAUC,MAAA,CAAOD,OAAP,CAAV;AACA,QAAIE,KAAA,CAAMF,OAAN,CAAJ,IAAsBA,OAAtB,GAAgC,CAAhC;AACE,YAAM,IAAIG,KAAJ,CAAU,kBAAV,GAA+BH,OAA/B,CAAN;AADF;AAGA,QAAAlG,MAAA,GAAakG,OAAb;AALW,GAAb;AAOE,QAAAlG,MAAA,GAAa,IAAb;AAPF;AAUA,SAAO,IAAP;AAb6C,CAA/C;AAoBA;;;AAAAV,IAAAG,IAAA+C,UAAA+B,QAAA,GAA6B+B,QAAQ,EAAG;AACtC,SAAO,IAAAtG,MAAP,IAAqB,IAArB;AADsC,CAAxC;AAQA;;;AAAAV,IAAAG,IAAA+C,UAAAtB,QAAA,GAA6BqF,QAAQ,EAAG;AACtC,SAAO,IAAAtG,MAAP;AADsC,CAAxC;AAaA;;;;;AAAAX,IAAAG,IAAA+C,UAAAvB,QAAA,GAA6BuF,QAAQ,CAACC,OAAD,EAAUtB,UAAV,CAAsB;AACzD,MAAAC,gBAAA,EAAA;AACA,MAAAnF,MAAA,GAAakF,UAAA,GAAa7F,IAAAG,IAAA4F,eAAA,CAAwBoB,OAAxB,EAAiC,IAAjC,CAAb,GAAsDA,OAAnE;AACA,SAAO,IAAP;AAHyD,CAA3D;AAUA;;;AAAAnH,IAAAG,IAAA+C,UAAAgC,QAAA,GAA6BkC,QAAQ,EAAG;AACtC,SAAO,CAAC,CAAC,IAAAzG,MAAT;AADsC,CAAxC;AAQA;;;AAAAX,IAAAG,IAAA+C,UAAAqC,SAAA,GAA8B8B,QAAQ,EAAG;AACvC,SAAO,IAAAtG,WAAAoC,SAAA,EAAP,KAAsC,EAAtC;AADuC,CAAzC;AAYA;;;;;AAAAnD,IAAAG,IAAA+C,UAAArB,aAAA,GAAkCyF,QAAQ,CAACC,SAAD,EAAY1B,UAAZ,CAAwB;AAChE,MAAAC,gBAAA,EAAA;AAEA,MAAIyB,SAAJ,YAAyBvH,IAAAG,IAAA2C,UAAzB,CAA6C;AAC3C,QAAA/B,WAAA,GAAkBwG,SAAlB;AACA,QAAAxG,WAAAyG,cAAA,CAA8B,IAAA1G,YAA9B,CAAA;AAF2C,GAA7C,KAGO;AACL,QAAI,CAAC+E,UAAL;AAGE0B,eAAA,GAAYvH,IAAAG,IAAAqD,oBAAA,CACR+D,SADQ,EACGvH,IAAAG,IAAAsH,qBADH,CAAZ;AAHF;AAMA,QAAA1G,WAAA,GAAkB,IAAIf,IAAAG,IAAA2C,UAAJ,CAAuByE,SAAvB,EAAkC,IAAlC,EAAwC,IAAAzG,YAAxC,CAAlB;AAPK;AAUP,SAAO,IAAP;AAhBgE,CAAlE;AA0BA;;;;;AAAAd,IAAAG,IAAA+C,UAAAwE,SAAA,GAA8BC,QAAQ,CAACC,QAAD,EAAW/B,UAAX,CAAuB;AAC3D,SAAO,IAAAhE,aAAA,CAAkB+F,QAAlB,EAA4B/B,UAA5B,CAAP;AAD2D,CAA7D;AAQA;;;AAAA7F,IAAAG,IAAA+C,UAAAoB,gBAAA,GAAqCuD,QAAQ,EAAG;AAC9C,SAAO,IAAA9G,WAAAoC,SAAA,EAAP;AAD8C,CAAhD;AAQA;;;AAAAnD,IAAAG,IAAA+C,UAAA4E,gBAAA,GAAqCC,QAAQ,EAAG;AAC9C,SAAO,IAAAhH,WAAAiH,gBAAA,EAAP;AAD8C,CAAhD;AASA;;;AAAAhI,IAAAG,IAAA+C,UAAApB,aAAA,GAAkCmG,QAAQ,EAAG;AAC3C,SAAO,IAAAlH,WAAP;AAD2C,CAA7C;AAWA;;;AAAAf,IAAAG,IAAA+C,UAAAgF,SAAA,GAA8BC,QAAQ,EAAG;AACvC,SAAO,IAAA7D,gBAAA,EAAP;AADuC,CAAzC;AAaA;;;;;AAAAtE,IAAAG,IAAA+C,UAAAkF,kBAAA,GAAuCC,QAAQ,CAACC,GAAD,EAAMC,KAAN,CAAa;AAC1D,MAAAzC,gBAAA,EAAA;AACA,MAAA/E,WAAAyH,IAAA,CAAoBF,GAApB,EAAyBC,KAAzB,CAAA;AACA,SAAO,IAAP;AAH0D,CAA5D;AAqBA;;;;;AAAAvI,IAAAG,IAAA+C,UAAAuF,mBAAA,GAAwCC,QAAQ,CAACJ,GAAD,EAAMK,MAAN,CAAc;AAC5D,MAAA7C,gBAAA,EAAA;AAEA,MAAI,CAAC9F,IAAA4I,QAAA,CAAaD,MAAb,CAAL;AACEA,UAAA,GAAS,CAACtG,MAAA,CAAOsG,MAAP,CAAD,CAAT;AADF;AAIA,MAAA5H,WAAA8H,UAAA,CAA0BP,GAA1B,EAA+BK,MAA/B,CAAA;AAEA,SAAO,IAAP;AAT4D,CAA9D;AAoBA;;;;AAAA3I,IAAAG,IAAA+C,UAAA4F,mBAAA,GAAwCC,QAAQ,CAACC,IAAD,CAAO;AACrD,SAAO,IAAAjI,WAAAkI,UAAA,CAA0BD,IAA1B,CAAP;AADqD,CAAvD;AAaA;;;;AAAAhJ,IAAAG,IAAA+C,UAAAgG,kBAAA,GAAuCC,QAAQ,CAACC,SAAD,CAAY;AACzD,4CAAuC,CAAC,IAAArI,WAAAsI,IAAA,CAAoBD,SAApB,CAAD,CAAvC;AADyD,CAA3D;AAQA;;;AAAApJ,IAAAG,IAAA+C,UAAAjB,YAAA,GAAiCqH,QAAQ,EAAG;AAC1C,SAAO,IAAA1I,UAAP;AAD0C,CAA5C;AAaA;;;;;AAAAZ,IAAAG,IAAA+C,UAAAlB,YAAA,GAAiCuH,QAAQ,CAACC,WAAD,EAAc3D,UAAd,CAA0B;AACjE,MAAAC,gBAAA,EAAA;AACA,MAAAlF,UAAA,GACIiF,UAAA,GAAa7F,IAAAG,IAAA4F,eAAA,CAAwByD,WAAxB,CAAb,GAAoDA,WADxD;AAEA,SAAO,IAAP;AAJiE,CAAnE;AAWA;;;AAAAxJ,IAAAG,IAAA+C,UAAAsC,YAAA,GAAiCiE,QAAQ,EAAG;AAC1C,SAAO,CAAC,CAAC,IAAA7I,UAAT;AAD0C,CAA5C;AAUA;;;;AAAAZ,IAAAG,IAAA+C,UAAAwG,gBAAA,GAAqCC,QAAQ,CAACC,IAAD,CAAO;AAClD,UAAS,CAAC,IAAA3F,UAAA,EAAV,IAA8B,CAAC2F,IAAA3F,UAAA,EAA/B,IACQ,IAAAzC,UAAA,EADR,IAC4BoI,IAAApI,UAAA,EAD5B,MAEM,CAAC,IAAAyD,QAAA,EAFP,IAEyB,CAAC2E,IAAA3E,QAAA,EAF1B,IAGK,IAAAvD,QAAA,EAHL,IAGuBkI,IAAAlI,QAAA,EAHvB;AADkD,CAApD;AAYA;;;AAAA1B,IAAAG,IAAA+C,UAAA2G,WAAA,GAAgCC,QAAQ,EAAG;AACzC,MAAAhE,gBAAA,EAAA;AACA,MAAAsC,kBAAA,CAAuBpI,IAAAG,IAAA4C,aAAvB,EAA8C/C,IAAA6D,OAAAkG,gBAAA,EAA9C,CAAA;AAEA,SAAO,IAAP;AAJyC,CAA3C;AAcA;;;;AAAA/J,IAAAG,IAAA+C,UAAA8G,gBAAA,GAAqCC,QAAQ,CAAC3B,GAAD,CAAM;AACjD,MAAAxC,gBAAA,EAAA;AACA,MAAA/E,WAAAmJ,OAAA,CAAuB5B,GAAvB,CAAA;AACA,SAAO,IAAP;AAHiD,CAAnD;AAcA;;;;AAAAtI,IAAAG,IAAA+C,UAAAiH,YAAA,GAAiCC,QAAQ,CAACC,UAAD,CAAa;AACpD,MAAAxJ,YAAA,GAAmBwJ,UAAnB;AACA,SAAO,IAAP;AAFoD,CAAtD;AASA;;;AAAArK,IAAAG,IAAA+C,UAAAmH,WAAA,GAAgCC,QAAQ,EAAG;AACzC,SAAO,IAAAzJ,YAAP;AADyC,CAA3C;AASAb,IAAAG,IAAA+C,UAAA4C,gBAAA,GAAqCyE,QAAQ,EAAG;AAC9C,MAAI,IAAA1J,YAAJ;AACE,UAAM,IAAIkG,KAAJ,CAAU,iCAAV,CAAN;AADF;AAD8C,CAAhD;AAcA;;;;AAAA/G,IAAAG,IAAA+C,UAAAsE,cAAA,GAAmCgD,QAAQ,CAACC,UAAD,CAAa;AACtD,MAAA3J,YAAA,GAAmB2J,UAAnB;AACA,MAAI,IAAA1J,WAAJ;AACE,QAAAA,WAAAyG,cAAA,CAA8BiD,UAA9B,CAAA;AADF;AAGA,SAAO,IAAP;AALsD,CAAxD;AAYA;;;AAAAzK,IAAAG,IAAA+C,UAAAhC,cAAA,GAAmCwJ,QAAQ,EAAG;AAC5C,SAAO,IAAA5J,YAAP;AAD4C,CAA9C;AAsBA;;;;;AAAAd,IAAAG,IAAAwK,MAAA,GAAiBC,QAAQ,CAAC1I,GAAD,EAAM5B,cAAN,CAAsB;AAC7C,SAAO4B,GAAA,YAAelC,IAAAG,IAAf,GAA0B+B,GAAAH,MAAA,EAA1B,GAC0B,IAAI/B,IAAAG,IAAJ,CAAa+B,GAAb,EAAkB5B,cAAlB,CADjC;AAD6C,CAA/C;AAqBA;;;;;;;;;;;AAAAN,IAAAG,IAAA0K,OAAA,GAAkBC,QAAQ,CACtBC,UADsB,EACVC,YADU,EACIC,UADJ,EACgBC,QADhB,EAC0BC,QAD1B,EACoCC,SADpC,EAEtBC,YAFsB,EAER/K,cAFQ,CAEQ;AAEhC,MAAI4B,MAAM,IAAIlC,IAAAG,IAAJ,CAAa,IAAb,EAAmBG,cAAnB,CAAV;AAGAyK,YAAA,IAAc7I,GAAAf,UAAA,CAAc4J,UAAd,CAAd;AACAC,cAAA,IAAgB9I,GAAAb,YAAA,CAAgB2J,YAAhB,CAAhB;AACAC,YAAA,IAAc/I,GAAAX,UAAA,CAAc0J,UAAd,CAAd;AACAC,UAAA,IAAYhJ,GAAAT,QAAA,CAAYyJ,QAAZ,CAAZ;AACAC,UAAA,IAAYjJ,GAAAP,QAAA,CAAYwJ,QAAZ,CAAZ;AACAC,WAAA,IAAalJ,GAAAL,aAAA,CAAiBuJ,SAAjB,CAAb;AACAC,cAAA,IAAgBnJ,GAAAF,YAAA,CAAgBqJ,YAAhB,CAAhB;AAEA,SAAOnJ,GAAP;AAbgC,CAFlC;AA2BA;;;;;AAAAlC,IAAAG,IAAAuE,QAAA,GAAmB4G,QAAQ,CAACC,IAAD,EAAOC,GAAP,CAAY;AACrC,MAAI,EAAED,IAAF,YAAkBvL,IAAAG,IAAlB,CAAJ;AACEoL,QAAA,GAAOvL,IAAAG,IAAAwK,MAAA,CAAeY,IAAf,CAAP;AADF;AAIA,MAAI,EAAEC,GAAF,YAAiBxL,IAAAG,IAAjB,CAAJ;AACEqL,OAAA,GAAMxL,IAAAG,IAAAwK,MAAA,CAAea,GAAf,CAAN;AADF;AAIA,SAAOD,IAAA7G,QAAA,CAAa8G,GAAb,CAAP;AATqC,CAAvC;AAoBA;;;;AAAAxL,IAAAG,IAAAmF,kBAAA,GAA6BmG,QAAQ,CAACzH,IAAD,CAAO;AAC1C,MAAIA,IAAJ,IAAY,IAAZ,IAAoBA,IAApB,IAA4B,GAA5B;AACE,WAAO,EAAP;AADF;AAGO,QACH,CAAChE,IAAA6D,OAAA6H,SAAA,CAAqB1H,IAArB,EAA2B,IAA3B,CADE,IACkC,CAAChE,IAAA6D,OAAA6H,SAAA,CAAqB1H,IAArB,EAA2B,IAA3B,CADnC;AAIL,aAAOA,IAAP;AAJK,UAMA;AACL,UAAI2H,eAAe3L,IAAA6D,OAAA+H,WAAA,CAAuB5H,IAAvB,EAA6B,GAA7B,CAAnB;AACA,UAAI6H,WAAW7H,IAAA5B,MAAA,CAAW,GAAX,CAAf;AACA,UAAIiB,MAAM,EAAV;AAEA,WAAK,IAAIyI,MAAM,CAAf,EAAkBA,GAAlB,GAAwBD,QAAAE,OAAxB,CAAA,CAA0C;AACxC,YAAIC,UAAUH,QAAA,CAASC,GAAA,EAAT,CAAd;AAEA,YAAIE,OAAJ,IAAe,GAAf;AACE,cAAIL,YAAJ,IAAoBG,GAApB,IAA2BD,QAAAE,OAA3B;AACE1I,eAAAE,KAAA,CAAS,EAAT,CAAA;AADF;AADF;AAIO,cAAIyI,OAAJ,IAAe,IAAf,CAAqB;AAC1B,gBAAI3I,GAAA0I,OAAJ,GAAiB,CAAjB,IAAsB1I,GAAA0I,OAAtB,IAAoC,CAApC,IAAyC1I,GAAA,CAAI,CAAJ,CAAzC,IAAmD,EAAnD;AACEA,iBAAA4I,IAAA,EAAA;AADF;AAGA,gBAAIN,YAAJ,IAAoBG,GAApB,IAA2BD,QAAAE,OAA3B;AACE1I,iBAAAE,KAAA,CAAS,EAAT,CAAA;AADF;AAJ0B,WAArB,KAOA;AACLF,eAAAE,KAAA,CAASyI,OAAT,CAAA;AACAL,wBAAA,GAAe,IAAf;AAFK;AAXP;AAHwC;AAoB1C,aAAOtI,GAAAoB,KAAA,CAAS,GAAT,CAAP;AAzBK;AATP;AAD0C,CAA5C;AAiDA;;;;;;AAAAzE,IAAAG,IAAA4F,eAAA,GAA0BmG,QAAQ,CAACC,GAAD,EAAMC,oBAAN,CAA4B;AAE5D,MAAI,CAACD,GAAL;AACE,WAAO,EAAP;AADF;AAOA,SAAOC,oBAAA,GAAuBC,SAAA,CAAUF,GAAAnG,QAAA,CAAY,MAAZ,EAAoB,OAApB,CAAV,CAAvB,GACuBsG,kBAAA,CAAmBH,GAAnB,CAD9B;AAT4D,CAA9D;AA0BA;;;;;;;AAAAnM,IAAAG,IAAAqD,oBAAA,GAA+B+I,QAAQ,CACnCC,aADmC,EACpBC,KADoB,EACbC,wBADa,CACa;AAClD,MAAI,MAAOF,cAAX,KAA6B,QAA7B,CAAuC;AACrC,QAAIG,UAAUC,SAAA,CAAUJ,aAAV,CAAAxG,QAAA,CAAiCyG,KAAjC,EAAwCzM,IAAAG,IAAA0M,YAAxC,CAAd;AACA,QAAIH,wBAAJ;AAGEC,aAAA,GAAU3M,IAAAG,IAAAyD,sBAAA,CAA+B+I,OAA/B,CAAV;AAHF;AAKA,WAAOA,OAAP;AAPqC;AASvC,SAAO,IAAP;AAVkD,CADpD;AAqBA;;;;;AAAA3M,IAAAG,IAAA0M,YAAA,GAAuBC,QAAQ,CAACC,EAAD,CAAK;AAClC,MAAIC,IAAID,EAAAE,WAAA,CAAc,CAAd,CAAR;AACA,SAAO,GAAP,GAAa9J,CAAE6J,CAAF7J,IAAO,CAAPA,GAAY,EAAZA,UAAA,CAA0B,EAA1B,CAAb,GAA6CA,CAAC6J,CAAD7J,GAAK,EAALA,UAAA,CAAmB,EAAnB,CAA7C;AAFkC,CAApC;AAYA;;;;;AAAAnD,IAAAG,IAAAyD,sBAAA,GAAiCsJ,QAAQ,CAACC,mBAAD,CAAsB;AAC7D,SAAOA,mBAAAnH,QAAA,CAA4B,sBAA5B,EAAoD,KAApD,CAAP;AAD6D,CAA/D;AAWA,+BAAAhG,IAAAG,IAAAsD,gCAAA,GAA2C,WAA3C;AASA,+BAAAzD,IAAAG,IAAAiE,4BAAA,GAAuC,SAAvC;AAQA,+BAAApE,IAAAG,IAAAgE,4BAAA,GAAuC,QAAvC;AAQA,+BAAAnE,IAAAG,IAAAsH,qBAAA,GAAgC,SAAhC;AAQA,+BAAAzH,IAAAG,IAAAqE,wBAAA,GAAmC,IAAnC;AASA;;;;;AAAAxE,IAAAG,IAAAiN,eAAA,GAA0BC,QAAQ,CAACC,UAAD,EAAaC,UAAb,CAAyB;AAGzD,MAAIC,UAAUxN,IAAAkC,IAAAC,MAAAC,MAAA,CAAqBkL,UAArB,CAAd;AACA,MAAIG,UAAUzN,IAAAkC,IAAAC,MAAAC,MAAA,CAAqBmL,UAArB,CAAd;AACA,SAAOC,OAAA,CAAQxN,IAAAkC,IAAAC,MAAAG,eAAAG,OAAR,CAAP,IACIgL,OAAA,CAAQzN,IAAAkC,IAAAC,MAAAG,eAAAG,OAAR,CADJ,IAEI+K,OAAA,CAAQxN,IAAAkC,IAAAC,MAAAG,eAAAI,KAAR,CAFJ,IAGI+K,OAAA,CAAQzN,IAAAkC,IAAAC,MAAAG,eAAAI,KAAR,CAHJ;AALyD,CAA3D;AA8BA;;;;;;;;AAAA1C,IAAAG,IAAA2C,UAAA,GAAqB4K,QAAQ,CAACtC,SAAD,EAAY/K,OAAZ,EAAqBC,cAArB,CAAqC;AAUhE,8DAAA,IAAAqN,QAAA,GAAe,IAAf;AAMA,kCAAA,IAAAC,OAAA,GAAc,IAAd;AAMA,kCAAA,IAAAC,cAAA,GAAqBzC,SAArB,IAAkC,IAAlC;AAMA,kCAAA,IAAAtK,YAAA,GAAmB,CAAC,CAACR,cAArB;AA5BgE,CAAlE;AAqCA,gBAAAN,IAAAG,IAAA2C,UAAAI,UAAA4K,yBAAA,GAAwDC,QAAQ,EAAG;AACjE,MAAI,CAAC,IAAAJ,QAAL,CAAmB;AACjB,QAAAA,QAAA,GAAe,IAAI3N,IAAAgO,QAAAC,IAAnB;AACA,QAAAL,OAAA,GAAc,CAAd;AACA,QAAI,IAAAC,cAAJ,CAAwB;AACtB,UAAIK,OAAO,IAAX;AACAlO,UAAAkC,IAAAC,MAAAgM,eAAA,CAA8B,IAAAN,cAA9B,EAAkD,QAAQ,CAAC7E,IAAD,EAAOT,KAAP,CAAc;AACtE2F,YAAAE,IAAA,CAASpO,IAAA6D,OAAAwK,UAAA,CAAsBrF,IAAtB,CAAT,EAAsCT,KAAtC,CAAA;AADsE,OAAxE,CAAA;AAFsB;AAHP;AAD8C,CAAnE;AA2BA;;;;;;AAAAvI,IAAAG,IAAA2C,UAAAwL,cAAA,GAAmCC,QAAQ,CAACC,GAAD,EAAMnO,OAAN,EAAeC,cAAf,CAA+B;AACxE,MAAImO,OAAOzO,IAAAgO,QAAAU,QAAA,CAAqBF,GAArB,CAAX;AACA,MAAI,MAAOC,KAAX,IAAmB,WAAnB;AACE,UAAM,IAAI1H,KAAJ,CAAU,oBAAV,CAAN;AADF;AAIA,MAAIQ,YAAY,IAAIvH,IAAAG,IAAA2C,UAAJ,CAAuB,IAAvB,EAA6B,IAA7B,EAAmCxC,cAAnC,CAAhB;AACA,MAAIqI,SAAS3I,IAAAgO,QAAA/E,UAAA,CAAuBuF,GAAvB,CAAb;AACA,OAAK,IAAIG,IAAI,CAAb,EAAgBA,CAAhB,GAAoBF,IAAA1C,OAApB,EAAiC4C,CAAA,EAAjC,CAAsC;AACpC,QAAIrG,MAAMmG,IAAA,CAAKE,CAAL,CAAV;AACA,QAAIpG,QAAQI,MAAA,CAAOgG,CAAP,CAAZ;AACA,QAAI,CAAC3O,IAAA4I,QAAA,CAAaL,KAAb,CAAL;AACEhB,eAAA6G,IAAA,CAAc9F,GAAd,EAAmBC,KAAnB,CAAA;AADF;AAGEhB,eAAAsB,UAAA,CAAoBP,GAApB,EAAyBC,KAAzB,CAAA;AAHF;AAHoC;AAStC,SAAOhB,SAAP;AAjBwE,CAA1E;AAkCA;;;;;;;AAAAvH,IAAAG,IAAA2C,UAAA8L,qBAAA,GAA0CC,QAAQ,CAC9CJ,IAD8C,EACxC9F,MADwC,EAChCtI,OADgC,EACvBC,cADuB,CACP;AACzC,MAAImO,IAAA1C,OAAJ,IAAmBpD,MAAAoD,OAAnB;AACE,UAAM,IAAIhF,KAAJ,CAAU,oCAAV,CAAN;AADF;AAGA,MAAIQ,YAAY,IAAIvH,IAAAG,IAAA2C,UAAJ,CAAuB,IAAvB,EAA6B,IAA7B,EAAmCxC,cAAnC,CAAhB;AACA,OAAK,IAAIqO,IAAI,CAAb,EAAgBA,CAAhB,GAAoBF,IAAA1C,OAApB,EAAiC4C,CAAA,EAAjC;AACEpH,aAAA6G,IAAA,CAAcK,IAAA,CAAKE,CAAL,CAAd,EAAuBhG,MAAA,CAAOgG,CAAP,CAAvB,CAAA;AADF;AAGA,SAAOpH,SAAP;AARyC,CAD3C;AAgBA;;;AAAAvH,IAAAG,IAAA2C,UAAAI,UAAA4L,SAAA,GAAwCC,QAAQ,EAAG;AACjD,MAAAjB,yBAAA,EAAA;AACA,SAAO,IAAAF,OAAP;AAFiD,CAAnD;AAYA;;;;;AAAA5N,IAAAG,IAAA2C,UAAAI,UAAAkL,IAAA,GAAmCY,QAAQ,CAAC1G,GAAD,EAAMC,KAAN,CAAa;AACtD,MAAAuF,yBAAA,EAAA;AACA,MAAAmB,iBAAA,EAAA;AAEA3G,KAAA,GAAM,IAAA4G,YAAA,CAAiB5G,GAAjB,CAAN;AACA,MAAIK,SAAS,IAAAgF,QAAAtE,IAAA,CAAiBf,GAAjB,CAAb;AACA,MAAI,CAACK,MAAL;AACE,QAAAgF,QAAAnF,IAAA,CAAiBF,GAAjB,EAAuBK,MAAvB,GAAgC,EAAhC,CAAA;AADF;AAGAA,QAAApF,KAAA,CAAYgF,KAAZ,CAAA;AACA,MAAAqF,OAAA,GAAc5N,IAAAmP,QAAAC,aAAA,CAA0B,IAAAxB,OAA1B,CAAd,GAAuD,CAAvD;AACA,SAAO,IAAP;AAXsD,CAAxD;AAoBA;;;;AAAA5N,IAAAG,IAAA2C,UAAAI,UAAAgH,OAAA,GAAsCmF,QAAQ,CAAC/G,GAAD,CAAM;AAClD,MAAAwF,yBAAA,EAAA;AAEAxF,KAAA,GAAM,IAAA4G,YAAA,CAAiB5G,GAAjB,CAAN;AACA,MAAI,IAAAqF,QAAA2B,YAAA,CAAyBhH,GAAzB,CAAJ,CAAmC;AACjC,QAAA2G,iBAAA,EAAA;AAGA,QAAArB,OAAA,GACI5N,IAAAmP,QAAAC,aAAA,CAA0B,IAAAxB,OAA1B,CADJ,GAC6C,IAAAD,QAAAtE,IAAA,CAAiBf,GAAjB,CAAAyD,OAD7C;AAEA,WAAO,IAAA4B,QAAAzD,OAAA,CAAoB5B,GAApB,CAAP;AANiC;AAQnC,SAAO,KAAP;AAZkD,CAApD;AAmBAtI,IAAAG,IAAA2C,UAAAI,UAAAqM,MAAA,GAAqCC,QAAQ,EAAG;AAC9C,MAAAP,iBAAA,EAAA;AACA,MAAAtB,QAAA,GAAe,IAAf;AACA,MAAAC,OAAA,GAAc,CAAd;AAH8C,CAAhD;AAUA;;;AAAA5N,IAAAG,IAAA2C,UAAAI,UAAAuM,QAAA,GAAuCC,QAAQ,EAAG;AAChD,MAAA5B,yBAAA,EAAA;AACA,SAAO,IAAAF,OAAP,IAAsB,CAAtB;AAFgD,CAAlD;AAWA;;;;AAAA5N,IAAAG,IAAA2C,UAAAI,UAAAoM,YAAA,GAA2CK,QAAQ,CAACrH,GAAD,CAAM;AACvD,MAAAwF,yBAAA,EAAA;AACAxF,KAAA,GAAM,IAAA4G,YAAA,CAAiB5G,GAAjB,CAAN;AACA,SAAO,IAAAqF,QAAA2B,YAAA,CAAyBhH,GAAzB,CAAP;AAHuD,CAAzD;AAYA;;;;AAAAtI,IAAAG,IAAA2C,UAAAI,UAAA0M,cAAA,GAA6CC,QAAQ,CAACtH,KAAD,CAAQ;AAI3D,MAAIuH,OAAO,IAAA7G,UAAA,EAAX;AACA,SAAOjJ,IAAA+P,MAAArE,SAAA,CAAoBoE,IAApB,EAA0BvH,KAA1B,CAAP;AAL2D,CAA7D;AAiBA;;;;;AAAAvI,IAAAG,IAAA2C,UAAAI,UAAA8M,QAAA,GAAuCC,QAAQ,CAACC,CAAD,EAAIC,SAAJ,CAAe;AAC5D,MAAArC,yBAAA,EAAA;AACA,MAAAH,QAAAqC,QAAA,CAAqB,QAAQ,CAACrH,MAAD,EAASL,GAAT,CAAc;AACzCtI,QAAA+P,MAAAC,QAAA,CAAmBrH,MAAnB,EAA2B,QAAQ,CAACJ,KAAD,CAAQ;AACzC2H,OAAAE,KAAA,CAAOD,SAAP,EAAkB5H,KAAlB,EAAyBD,GAAzB,EAA8B,IAA9B,CAAA;AADyC,KAA3C,EAEG,IAFH,CAAA;AADyC,GAA3C,EAIG,IAJH,CAAA;AAF4D,CAA9D;AAeA;;;AAAAtI,IAAAG,IAAA2C,UAAAI,UAAAwL,QAAA,GAAuC2B,QAAQ,EAAG;AAChD,MAAAvC,yBAAA,EAAA;AAEA,MAAIgC,OAAO,IAAAnC,QAAA1E,UAAA,EAAX;AACA,MAAIwF,OAAO,IAAAd,QAAAe,QAAA,EAAX;AACA,MAAI4B,KAAK,EAAT;AACA,OAAK,IAAI3B,IAAI,CAAb,EAAgBA,CAAhB,GAAoBF,IAAA1C,OAApB,EAAiC4C,CAAA,EAAjC,CAAsC;AACpC,QAAIxC,MAAM2D,IAAA,CAAKnB,CAAL,CAAV;AACA,SAAK,IAAI4B,IAAI,CAAb,EAAgBA,CAAhB,GAAoBpE,GAAAJ,OAApB,EAAgCwE,CAAA,EAAhC;AACED,QAAA/M,KAAA,CAAQkL,IAAA,CAAKE,CAAL,CAAR,CAAA;AADF;AAFoC;AAMtC,SAAO2B,EAAP;AAZgD,CAAlD;AAuBA;;;;AAAAtQ,IAAAG,IAAA2C,UAAAI,UAAA+F,UAAA,GAAyCuH,QAAQ,CAACC,OAAD,CAAU;AACzD,MAAA3C,yBAAA,EAAA;AACA,MAAIwC,KAAK,EAAT;AACA,MAAI,MAAOG,QAAX,KAAuB,QAAvB;AACE,QAAI,IAAAnB,YAAA,CAAiBmB,OAAjB,CAAJ;AACEH,QAAA,GAAKtQ,IAAA+P,MAAAW,OAAA,CAAkBJ,EAAlB,EAAsB,IAAA3C,QAAAtE,IAAA,CAAiB,IAAA6F,YAAA,CAAiBuB,OAAjB,CAAjB,CAAtB,CAAL;AADF;AADF,QAIO;AAEL,QAAI9H,SAAS,IAAAgF,QAAA1E,UAAA,EAAb;AACA,SAAK,IAAI0F,IAAI,CAAb,EAAgBA,CAAhB,GAAoBhG,MAAAoD,OAApB,EAAmC4C,CAAA,EAAnC;AACE2B,QAAA,GAAKtQ,IAAA+P,MAAAW,OAAA,CAAkBJ,EAAlB,EAAsB3H,MAAA,CAAOgG,CAAP,CAAtB,CAAL;AADF;AAHK;AAOP,SAAO2B,EAAP;AAdyD,CAA3D;AAyBA;;;;;AAAAtQ,IAAAG,IAAA2C,UAAAI,UAAAsF,IAAA,GAAmCmI,QAAQ,CAACrI,GAAD,EAAMC,KAAN,CAAa;AACtD,MAAAuF,yBAAA,EAAA;AACA,MAAAmB,iBAAA,EAAA;AAOA3G,KAAA,GAAM,IAAA4G,YAAA,CAAiB5G,GAAjB,CAAN;AACA,MAAI,IAAAgH,YAAA,CAAiBhH,GAAjB,CAAJ;AACE,QAAAsF,OAAA,GACI5N,IAAAmP,QAAAC,aAAA,CAA0B,IAAAxB,OAA1B,CADJ,GAC6C,IAAAD,QAAAtE,IAAA,CAAiBf,GAAjB,CAAAyD,OAD7C;AADF;AAIA,MAAA4B,QAAAnF,IAAA,CAAiBF,GAAjB,EAAsB,CAACC,KAAD,CAAtB,CAAA;AACA,MAAAqF,OAAA,GAAc5N,IAAAmP,QAAAC,aAAA,CAA0B,IAAAxB,OAA1B,CAAd,GAAuD,CAAvD;AACA,SAAO,IAAP;AAhBsD,CAAxD;AA6BA;;;;;AAAA5N,IAAAG,IAAA2C,UAAAI,UAAAmG,IAAA,GAAmCuH,QAAQ,CAACtI,GAAD,EAAMuI,WAAN,CAAmB;AAC5D,MAAI,CAACvI,GAAL;AACE,WAAOuI,WAAP;AADF;AAGA,MAAIlI,SAAS,IAAAM,UAAA,CAAeX,GAAf,CAAb;AACA,SAAOK,MAAAoD,OAAA,GAAgB,CAAhB,GAAoB1J,MAAA,CAAOsG,MAAA,CAAO,CAAP,CAAP,CAApB,GAAwCkI,WAA/C;AAL4D,CAA9D;AAeA;;;;AAAA7Q,IAAAG,IAAA2C,UAAAI,UAAA2F,UAAA,GAAyCiI,QAAQ,CAACxI,GAAD,EAAMK,MAAN,CAAc;AAC7D,MAAAuB,OAAA,CAAY5B,GAAZ,CAAA;AAEA,MAAIK,MAAAoD,OAAJ,GAAoB,CAApB,CAAuB;AACrB,QAAAkD,iBAAA,EAAA;AACA,QAAAtB,QAAAnF,IAAA,CAAiB,IAAA0G,YAAA,CAAiB5G,GAAjB,CAAjB,EAAwCtI,IAAA+P,MAAAhO,MAAA,CAAiB4G,MAAjB,CAAxC,CAAA;AACA,QAAAiF,OAAA,GAAc5N,IAAAmP,QAAAC,aAAA,CAA0B,IAAAxB,OAA1B,CAAd,GAAuDjF,MAAAoD,OAAvD;AAHqB;AAHsC,CAA/D;AAeA;;;;AAAA/L,IAAAG,IAAA2C,UAAAI,UAAAC,SAAA,GAAwC4N,QAAQ,EAAG;AACjD,MAAI,IAAAlD,cAAJ;AACE,WAAO,IAAAA,cAAP;AADF;AAIA,MAAI,CAAC,IAAAF,QAAL;AACE,WAAO,EAAP;AADF;AAIA,MAAIqD,KAAK,EAAT;AAKA,MAAIvC,OAAO,IAAAd,QAAAe,QAAA,EAAX;AACA,OAAK,IAAIC,IAAI,CAAb,EAAgBA,CAAhB,GAAoBF,IAAA1C,OAApB,EAAiC4C,CAAA,EAAjC,CAAsC;AACpC,QAAIrG,MAAMmG,IAAA,CAAKE,CAAL,CAAV;AACA,QAAIsC,aAAajR,IAAA6D,OAAAC,UAAA,CAAsBwE,GAAtB,CAAjB;AACA,QAAI6D,MAAM,IAAAlD,UAAA,CAAeX,GAAf,CAAV;AACA,SAAK,IAAIiI,IAAI,CAAb,EAAgBA,CAAhB,GAAoBpE,GAAAJ,OAApB,EAAgCwE,CAAA,EAAhC,CAAqC;AACnC,UAAIW,QAAQD,UAAZ;AAGA,UAAI9E,GAAA,CAAIoE,CAAJ,CAAJ,KAAe,EAAf;AACEW,aAAA,IAAS,MAAT,GAAelR,IAAA6D,OAAAC,UAAA,CAAsBqI,GAAA,CAAIoE,CAAJ,CAAtB,CAAf;AADF;AAGAS,QAAAzN,KAAA,CAAQ2N,KAAR,CAAA;AAPmC;AAJD;AAetC,SAAO,IAAArD,cAAP,GAA4BmD,EAAAvM,KAAA,CAAQ,MAAR,CAA5B;AA9BiD,CAAnD;AAuCA;;;AAAAzE,IAAAG,IAAA2C,UAAAI,UAAA8E,gBAAA,GAA+CmJ,QAAQ,EAAG;AACxD,SAAOnR,IAAAG,IAAA4F,eAAA,CAAwB,IAAA5C,SAAA,EAAxB,CAAP;AADwD,CAA1D;AASA,gBAAAnD,IAAAG,IAAA2C,UAAAI,UAAA+L,iBAAA,GAAgDmC,QAAQ,EAAG;AACzD,MAAAvD,cAAA,GAAqB,IAArB;AADyD,CAA3D;AAUA;;;;AAAA7N,IAAAG,IAAA2C,UAAAI,UAAAmO,WAAA,GAA0CC,QAAQ,CAAC7C,IAAD,CAAO;AACvD,MAAAX,yBAAA,EAAA;AACA,MAAAH,QAAAqC,QAAA,CAAqB,QAAQ,CAACzH,KAAD,EAAQD,GAAR,CAAa;AACxC,QAAI,CAACtI,IAAA+P,MAAArE,SAAA,CAAoB+C,IAApB,EAA0BnG,GAA1B,CAAL;AACE,UAAA4B,OAAA,CAAY5B,GAAZ,CAAA;AADF;AADwC,GAA1C,EAIG,IAJH,CAAA;AAKA,SAAO,IAAP;AAPuD,CAAzD;AAeA;;;AAAAtI,IAAAG,IAAA2C,UAAAI,UAAAnB,MAAA,GAAqCwP,QAAQ,EAAG;AAC9C,MAAIjB,KAAK,IAAItQ,IAAAG,IAAA2C,UAAb;AACAwN,IAAAzC,cAAA,GAAmB,IAAAA,cAAnB;AACA,MAAI,IAAAF,QAAJ,CAAkB;AAChB2C,MAAA3C,QAAA,GAAa,IAAAA,QAAA5L,MAAA,EAAb;AACAuO,MAAA1C,OAAA,GAAY,IAAAA,OAAZ;AAFgB;AAIlB,SAAO0C,EAAP;AAP8C,CAAhD;AAkBA;;;;;AAAAtQ,IAAAG,IAAA2C,UAAAI,UAAAgM,YAAA,GAA2CsC,QAAQ,CAACC,GAAD,CAAM;AACvD,MAAIC,UAAUrP,MAAA,CAAOoP,GAAP,CAAd;AACA,MAAI,IAAA3Q,YAAJ;AACE4Q,WAAA,GAAUA,OAAAC,YAAA,EAAV;AADF;AAGA,SAAOD,OAAP;AALuD,CAAzD;AAeA;;;AAAA1R,IAAAG,IAAA2C,UAAAI,UAAAsE,cAAA,GAA6CoK,QAAQ,CAACnH,UAAD,CAAa;AAChE,MAAIoH,YAAYpH,UAAZoH,IAA0B,CAAC,IAAA/Q,YAA/B;AACA,MAAI+Q,SAAJ,CAAe;AACb,QAAA/D,yBAAA,EAAA;AACA,QAAAmB,iBAAA,EAAA;AACA,QAAAtB,QAAAqC,QAAA,CAAqB,QAAQ,CAACzH,KAAD,EAAQD,GAAR,CAAa;AACxC,UAAIwJ,YAAYxJ,GAAAqJ,YAAA,EAAhB;AACA,UAAIrJ,GAAJ,IAAWwJ,SAAX,CAAsB;AACpB,YAAA5H,OAAA,CAAY5B,GAAZ,CAAA;AACA,YAAAO,UAAA,CAAeiJ,SAAf,EAA0BvJ,KAA1B,CAAA;AAFoB;AAFkB,KAA1C,EAMG,IANH,CAAA;AAHa;AAWf,MAAAzH,YAAA,GAAmB2J,UAAnB;AAbgE,CAAlE;AA2BA;;;;AAAAzK,IAAAG,IAAA2C,UAAAI,UAAA6O,OAAA,GAAsCC,QAAQ,CAACC,QAAD,CAAW;AACvD,OAAK,IAAItD,IAAI,CAAb,EAAgBA,CAAhB,GAAoBuD,SAAAnG,OAApB,EAAsC4C,CAAA,EAAtC,CAA2C;AACzC,QAAIwD,OAAOD,SAAA,CAAUvD,CAAV,CAAX;AACA3O,QAAAgO,QAAAgC,QAAA,CACImC,IADJ,EACU,QAAQ,CAAC5J,KAAD,EAAQD,GAAR,CAAa;AAAE,UAAA8F,IAAA,CAAS9F,GAAT,EAAcC,KAAd,CAAA;AAAF,KAD/B,EAC0D,IAD1D,CAAA;AAFyC;AADY,CAAzD;;",
"sources":["goog/uri/uri.js"],
"sourcesContent":["// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Class for parsing and formatting URIs.\n *\n * Use goog.Uri(string) to parse a URI string.  Use goog.Uri.create(...) to\n * create a new instance of the goog.Uri object from Uri parts.\n *\n * e.g: <code>var myUri = new goog.Uri(window.location);</code>\n *\n * Implements RFC 3986 for parsing/formatting URIs.\n * http://www.ietf.org/rfc/rfc3986.txt\n *\n * Some changes have been made to the interface (more like .NETs), though the\n * internal representation is now of un-encoded parts, this will change the\n * behavior slightly.\n *\n * @author msamuel@google.com (Mike Samuel)\n */\n\ngoog.provide('goog.Uri');\ngoog.provide('goog.Uri.QueryData');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.string');\ngoog.require('goog.structs');\ngoog.require('goog.structs.Map');\ngoog.require('goog.uri.utils');\ngoog.require('goog.uri.utils.ComponentIndex');\ngoog.require('goog.uri.utils.StandardQueryParam');\n\n\n\n/**\n * This class contains setters and getters for the parts of the URI.\n * The <code>getXyz</code>/<code>setXyz</code> methods return the decoded part\n * -- so<code>goog.Uri.parse('/foo%20bar').getPath()</code> will return the\n * decoded path, <code>/foo bar</code>.\n *\n * Reserved characters (see RFC 3986 section 2.2) can be present in\n * their percent-encoded form in scheme, domain, and path URI components and\n * will not be auto-decoded. For example:\n * <code>goog.Uri.parse('rel%61tive/path%2fto/resource').getPath()</code> will\n * return <code>relative/path%2fto/resource</code>.\n *\n * The constructor accepts an optional unparsed, raw URI string.  The parser\n * is relaxed, so special characters that aren't escaped but don't cause\n * ambiguities will not cause parse failures.\n *\n * All setters return <code>this</code> and so may be chained, a la\n * <code>goog.Uri.parse('/foo').setFragment('part').toString()</code>.\n *\n * @param {*=} opt_uri Optional string URI to parse\n *        (use goog.Uri.create() to create a URI from parts), or if\n *        a goog.Uri is passed, a clone is created.\n * @param {boolean=} opt_ignoreCase If true, #getParameterValue will ignore\n * the case of the parameter name.\n *\n * @throws URIError If opt_uri is provided and URI is malformed (that is,\n *     if decodeURIComponent fails on any of the URI components).\n * @constructor\n * @struct\n */\ngoog.Uri = function(opt_uri, opt_ignoreCase) {\n  /**\n   * Scheme such as \"http\".\n   * @private {string}\n   */\n  this.scheme_ = '';\n\n  /**\n   * User credentials in the form \"username:password\".\n   * @private {string}\n   */\n  this.userInfo_ = '';\n\n  /**\n   * Domain part, e.g. \"www.google.com\".\n   * @private {string}\n   */\n  this.domain_ = '';\n\n  /**\n   * Port, e.g. 8080.\n   * @private {?number}\n   */\n  this.port_ = null;\n\n  /**\n   * Path, e.g. \"/tests/img.png\".\n   * @private {string}\n   */\n  this.path_ = '';\n\n  /**\n   * The fragment without the #.\n   * @private {string}\n   */\n  this.fragment_ = '';\n\n  /**\n   * Whether or not this Uri should be treated as Read Only.\n   * @private {boolean}\n   */\n  this.isReadOnly_ = false;\n\n  /**\n   * Whether or not to ignore case when comparing query params.\n   * @private {boolean}\n   */\n  this.ignoreCase_ = false;\n\n  /**\n   * Object representing query data.\n   * @private {!goog.Uri.QueryData}\n   */\n  this.queryData_;\n\n  // Parse in the uri string\n  var m;\n  if (opt_uri instanceof goog.Uri) {\n    this.ignoreCase_ = (opt_ignoreCase !== undefined) ? opt_ignoreCase :\n                                                        opt_uri.getIgnoreCase();\n    this.setScheme(opt_uri.getScheme());\n    this.setUserInfo(opt_uri.getUserInfo());\n    this.setDomain(opt_uri.getDomain());\n    this.setPort(opt_uri.getPort());\n    this.setPath(opt_uri.getPath());\n    this.setQueryData(opt_uri.getQueryData().clone());\n    this.setFragment(opt_uri.getFragment());\n  } else if (opt_uri && (m = goog.uri.utils.split(String(opt_uri)))) {\n    this.ignoreCase_ = !!opt_ignoreCase;\n\n    // Set the parts -- decoding as we do so.\n    // COMPATIBILITY NOTE - In IE, unmatched fields may be empty strings,\n    // whereas in other browsers they will be undefined.\n    this.setScheme(m[goog.uri.utils.ComponentIndex.SCHEME] || '', true);\n    this.setUserInfo(m[goog.uri.utils.ComponentIndex.USER_INFO] || '', true);\n    this.setDomain(m[goog.uri.utils.ComponentIndex.DOMAIN] || '', true);\n    this.setPort(m[goog.uri.utils.ComponentIndex.PORT]);\n    this.setPath(m[goog.uri.utils.ComponentIndex.PATH] || '', true);\n    this.setQueryData(m[goog.uri.utils.ComponentIndex.QUERY_DATA] || '', true);\n    this.setFragment(m[goog.uri.utils.ComponentIndex.FRAGMENT] || '', true);\n\n  } else {\n    this.ignoreCase_ = !!opt_ignoreCase;\n    this.queryData_ = new goog.Uri.QueryData(null, null, this.ignoreCase_);\n  }\n};\n\n\n/**\n * Parameter name added to stop caching.\n * @type {string}\n */\ngoog.Uri.RANDOM_PARAM = goog.uri.utils.StandardQueryParam.RANDOM;\n\n\n/**\n * @return {string} The string form of the url.\n * @override\n */\ngoog.Uri.prototype.toString = function() {\n  var out = [];\n\n  var scheme = this.getScheme();\n  if (scheme) {\n    out.push(\n        goog.Uri.encodeSpecialChars_(\n            scheme, goog.Uri.reDisallowedInSchemeOrUserInfo_, true),\n        ':');\n  }\n\n  var domain = this.getDomain();\n  if (domain || scheme == 'file') {\n    out.push('//');\n\n    var userInfo = this.getUserInfo();\n    if (userInfo) {\n      out.push(\n          goog.Uri.encodeSpecialChars_(\n              userInfo, goog.Uri.reDisallowedInSchemeOrUserInfo_, true),\n          '@');\n    }\n\n    out.push(goog.Uri.removeDoubleEncoding_(goog.string.urlEncode(domain)));\n\n    var port = this.getPort();\n    if (port != null) {\n      out.push(':', String(port));\n    }\n  }\n\n  var path = this.getPath();\n  if (path) {\n    if (this.hasDomain() && path.charAt(0) != '/') {\n      out.push('/');\n    }\n    out.push(\n        goog.Uri.encodeSpecialChars_(\n            path, path.charAt(0) == '/' ? goog.Uri.reDisallowedInAbsolutePath_ :\n                                          goog.Uri.reDisallowedInRelativePath_,\n            true));\n  }\n\n  var query = this.getEncodedQuery();\n  if (query) {\n    out.push('?', query);\n  }\n\n  var fragment = this.getFragment();\n  if (fragment) {\n    out.push(\n        '#', goog.Uri.encodeSpecialChars_(\n                 fragment, goog.Uri.reDisallowedInFragment_));\n  }\n  return out.join('');\n};\n\n\n/**\n * Resolves the given relative URI (a goog.Uri object), using the URI\n * represented by this instance as the base URI.\n *\n * There are several kinds of relative URIs:<br>\n * 1. foo - replaces the last part of the path, the whole query and fragment<br>\n * 2. /foo - replaces the path, the query and fragment<br>\n * 3. //foo - replaces everything from the domain on.  foo is a domain name<br>\n * 4. ?foo - replace the query and fragment<br>\n * 5. #foo - replace the fragment only\n *\n * Additionally, if relative URI has a non-empty path, all \"..\" and \".\"\n * segments will be resolved, as described in RFC 3986.\n *\n * @param {!goog.Uri} relativeUri The relative URI to resolve.\n * @return {!goog.Uri} The resolved URI.\n */\ngoog.Uri.prototype.resolve = function(relativeUri) {\n\n  var absoluteUri = this.clone();\n\n  // we satisfy these conditions by looking for the first part of relativeUri\n  // that is not blank and applying defaults to the rest\n\n  var overridden = relativeUri.hasScheme();\n\n  if (overridden) {\n    absoluteUri.setScheme(relativeUri.getScheme());\n  } else {\n    overridden = relativeUri.hasUserInfo();\n  }\n\n  if (overridden) {\n    absoluteUri.setUserInfo(relativeUri.getUserInfo());\n  } else {\n    overridden = relativeUri.hasDomain();\n  }\n\n  if (overridden) {\n    absoluteUri.setDomain(relativeUri.getDomain());\n  } else {\n    overridden = relativeUri.hasPort();\n  }\n\n  var path = relativeUri.getPath();\n  if (overridden) {\n    absoluteUri.setPort(relativeUri.getPort());\n  } else {\n    overridden = relativeUri.hasPath();\n    if (overridden) {\n      // resolve path properly\n      if (path.charAt(0) != '/') {\n        // path is relative\n        if (this.hasDomain() && !this.hasPath()) {\n          // RFC 3986, section 5.2.3, case 1\n          path = '/' + path;\n        } else {\n          // RFC 3986, section 5.2.3, case 2\n          var lastSlashIndex = absoluteUri.getPath().lastIndexOf('/');\n          if (lastSlashIndex != -1) {\n            path = absoluteUri.getPath().substr(0, lastSlashIndex + 1) + path;\n          }\n        }\n      }\n      path = goog.Uri.removeDotSegments(path);\n    }\n  }\n\n  if (overridden) {\n    absoluteUri.setPath(path);\n  } else {\n    overridden = relativeUri.hasQuery();\n  }\n\n  if (overridden) {\n    absoluteUri.setQueryData(relativeUri.getQueryData().clone());\n  } else {\n    overridden = relativeUri.hasFragment();\n  }\n\n  if (overridden) {\n    absoluteUri.setFragment(relativeUri.getFragment());\n  }\n\n  return absoluteUri;\n};\n\n\n/**\n * Clones the URI instance.\n * @return {!goog.Uri} New instance of the URI object.\n */\ngoog.Uri.prototype.clone = function() {\n  return new goog.Uri(this);\n};\n\n\n/**\n * @return {string} The encoded scheme/protocol for the URI.\n */\ngoog.Uri.prototype.getScheme = function() {\n  return this.scheme_;\n};\n\n\n/**\n * Sets the scheme/protocol.\n * @throws URIError If opt_decode is true and newScheme is malformed (that is,\n *     if decodeURIComponent fails).\n * @param {string} newScheme New scheme value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setScheme = function(newScheme, opt_decode) {\n  this.enforceReadOnly();\n  this.scheme_ =\n      opt_decode ? goog.Uri.decodeOrEmpty_(newScheme, true) : newScheme;\n\n  // remove an : at the end of the scheme so somebody can pass in\n  // window.location.protocol\n  if (this.scheme_) {\n    this.scheme_ = this.scheme_.replace(/:$/, '');\n  }\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the scheme has been set.\n */\ngoog.Uri.prototype.hasScheme = function() {\n  return !!this.scheme_;\n};\n\n\n/**\n * @return {string} The decoded user info.\n */\ngoog.Uri.prototype.getUserInfo = function() {\n  return this.userInfo_;\n};\n\n\n/**\n * Sets the userInfo.\n * @throws URIError If opt_decode is true and newUserInfo is malformed (that is,\n *     if decodeURIComponent fails).\n * @param {string} newUserInfo New userInfo value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setUserInfo = function(newUserInfo, opt_decode) {\n  this.enforceReadOnly();\n  this.userInfo_ =\n      opt_decode ? goog.Uri.decodeOrEmpty_(newUserInfo) : newUserInfo;\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the user info has been set.\n */\ngoog.Uri.prototype.hasUserInfo = function() {\n  return !!this.userInfo_;\n};\n\n\n/**\n * @return {string} The decoded domain.\n */\ngoog.Uri.prototype.getDomain = function() {\n  return this.domain_;\n};\n\n\n/**\n * Sets the domain.\n * @throws URIError If opt_decode is true and newDomain is malformed (that is,\n *     if decodeURIComponent fails).\n * @param {string} newDomain New domain value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setDomain = function(newDomain, opt_decode) {\n  this.enforceReadOnly();\n  this.domain_ =\n      opt_decode ? goog.Uri.decodeOrEmpty_(newDomain, true) : newDomain;\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the domain has been set.\n */\ngoog.Uri.prototype.hasDomain = function() {\n  return !!this.domain_;\n};\n\n\n/**\n * @return {?number} The port number.\n */\ngoog.Uri.prototype.getPort = function() {\n  return this.port_;\n};\n\n\n/**\n * Sets the port number.\n * @param {*} newPort Port number. Will be explicitly casted to a number.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setPort = function(newPort) {\n  this.enforceReadOnly();\n\n  if (newPort) {\n    newPort = Number(newPort);\n    if (isNaN(newPort) || newPort < 0) {\n      throw new Error('Bad port number ' + newPort);\n    }\n    this.port_ = newPort;\n  } else {\n    this.port_ = null;\n  }\n\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the port has been set.\n */\ngoog.Uri.prototype.hasPort = function() {\n  return this.port_ != null;\n};\n\n\n/**\n  * @return {string} The decoded path.\n */\ngoog.Uri.prototype.getPath = function() {\n  return this.path_;\n};\n\n\n/**\n * Sets the path.\n * @throws URIError If opt_decode is true and newPath is malformed (that is,\n *     if decodeURIComponent fails).\n * @param {string} newPath New path value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setPath = function(newPath, opt_decode) {\n  this.enforceReadOnly();\n  this.path_ = opt_decode ? goog.Uri.decodeOrEmpty_(newPath, true) : newPath;\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the path has been set.\n */\ngoog.Uri.prototype.hasPath = function() {\n  return !!this.path_;\n};\n\n\n/**\n * @return {boolean} Whether the query string has been set.\n */\ngoog.Uri.prototype.hasQuery = function() {\n  return this.queryData_.toString() !== '';\n};\n\n\n/**\n * Sets the query data.\n * @param {goog.Uri.QueryData|string|undefined} queryData QueryData object.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n *     Applies only if queryData is a string.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setQueryData = function(queryData, opt_decode) {\n  this.enforceReadOnly();\n\n  if (queryData instanceof goog.Uri.QueryData) {\n    this.queryData_ = queryData;\n    this.queryData_.setIgnoreCase(this.ignoreCase_);\n  } else {\n    if (!opt_decode) {\n      // QueryData accepts encoded query string, so encode it if\n      // opt_decode flag is not true.\n      queryData = goog.Uri.encodeSpecialChars_(\n          queryData, goog.Uri.reDisallowedInQuery_);\n    }\n    this.queryData_ = new goog.Uri.QueryData(queryData, null, this.ignoreCase_);\n  }\n\n  return this;\n};\n\n\n/**\n * Sets the URI query.\n * @param {string} newQuery New query value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setQuery = function(newQuery, opt_decode) {\n  return this.setQueryData(newQuery, opt_decode);\n};\n\n\n/**\n * @return {string} The encoded URI query, not including the ?.\n */\ngoog.Uri.prototype.getEncodedQuery = function() {\n  return this.queryData_.toString();\n};\n\n\n/**\n * @return {string} The decoded URI query, not including the ?.\n */\ngoog.Uri.prototype.getDecodedQuery = function() {\n  return this.queryData_.toDecodedString();\n};\n\n\n/**\n * Returns the query data.\n * @return {!goog.Uri.QueryData} QueryData object.\n */\ngoog.Uri.prototype.getQueryData = function() {\n  return this.queryData_;\n};\n\n\n/**\n * @return {string} The encoded URI query, not including the ?.\n *\n * Warning: This method, unlike other getter methods, returns encoded\n * value, instead of decoded one.\n */\ngoog.Uri.prototype.getQuery = function() {\n  return this.getEncodedQuery();\n};\n\n\n/**\n * Sets the value of the named query parameters, clearing previous values for\n * that key.\n *\n * @param {string} key The parameter to set.\n * @param {*} value The new value. Value does not need to be encoded.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setParameterValue = function(key, value) {\n  this.enforceReadOnly();\n  this.queryData_.set(key, value);\n  return this;\n};\n\n\n/**\n * Sets the values of the named query parameters, clearing previous values for\n * that key.  Not new values will currently be moved to the end of the query\n * string.\n *\n * So, <code>goog.Uri.parse('foo?a=b&c=d&e=f').setParameterValues('c', ['new'])\n * </code> yields <tt>foo?a=b&e=f&c=new</tt>.</p>\n *\n * @param {string} key The parameter to set.\n * @param {*} values The new values. If values is a single\n *     string then it will be treated as the sole value. Values do not need to\n *     be encoded.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setParameterValues = function(key, values) {\n  this.enforceReadOnly();\n\n  if (!goog.isArray(values)) {\n    values = [String(values)];\n  }\n\n  this.queryData_.setValues(key, values);\n\n  return this;\n};\n\n\n/**\n * Returns the value<b>s</b> for a given cgi parameter as a list of decoded\n * query parameter values.\n * @param {string} name The parameter to get values for.\n * @return {!Array<?>} The values for a given cgi parameter as a list of\n *     decoded query parameter values.\n */\ngoog.Uri.prototype.getParameterValues = function(name) {\n  return this.queryData_.getValues(name);\n};\n\n\n/**\n * Returns the first value for a given cgi parameter or undefined if the given\n * parameter name does not appear in the query string.\n * @param {string} paramName Unescaped parameter name.\n * @return {string|undefined} The first value for a given cgi parameter or\n *     undefined if the given parameter name does not appear in the query\n *     string.\n */\ngoog.Uri.prototype.getParameterValue = function(paramName) {\n  return /** @type {string|undefined} */ (this.queryData_.get(paramName));\n};\n\n\n/**\n * @return {string} The URI fragment, not including the #.\n */\ngoog.Uri.prototype.getFragment = function() {\n  return this.fragment_;\n};\n\n\n/**\n * Sets the URI fragment.\n * @throws URIError If opt_decode is true and newFragment is malformed (that is,\n *     if decodeURIComponent fails).\n * @param {string} newFragment New fragment value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setFragment = function(newFragment, opt_decode) {\n  this.enforceReadOnly();\n  this.fragment_ =\n      opt_decode ? goog.Uri.decodeOrEmpty_(newFragment) : newFragment;\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the URI has a fragment set.\n */\ngoog.Uri.prototype.hasFragment = function() {\n  return !!this.fragment_;\n};\n\n\n/**\n * Returns true if this has the same domain as that of uri2.\n * @param {!goog.Uri} uri2 The URI object to compare to.\n * @return {boolean} true if same domain; false otherwise.\n */\ngoog.Uri.prototype.hasSameDomainAs = function(uri2) {\n  return ((!this.hasDomain() && !uri2.hasDomain()) ||\n          this.getDomain() == uri2.getDomain()) &&\n      ((!this.hasPort() && !uri2.hasPort()) ||\n       this.getPort() == uri2.getPort());\n};\n\n\n/**\n * Adds a random parameter to the Uri.\n * @return {!goog.Uri} Reference to this Uri object.\n */\ngoog.Uri.prototype.makeUnique = function() {\n  this.enforceReadOnly();\n  this.setParameterValue(goog.Uri.RANDOM_PARAM, goog.string.getRandomString());\n\n  return this;\n};\n\n\n/**\n * Removes the named query parameter.\n *\n * @param {string} key The parameter to remove.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.removeParameter = function(key) {\n  this.enforceReadOnly();\n  this.queryData_.remove(key);\n  return this;\n};\n\n\n/**\n * Sets whether Uri is read only. If this goog.Uri is read-only,\n * enforceReadOnly_ will be called at the start of any function that may modify\n * this Uri.\n * @param {boolean} isReadOnly whether this goog.Uri should be read only.\n * @return {!goog.Uri} Reference to this Uri object.\n */\ngoog.Uri.prototype.setReadOnly = function(isReadOnly) {\n  this.isReadOnly_ = isReadOnly;\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the URI is read only.\n */\ngoog.Uri.prototype.isReadOnly = function() {\n  return this.isReadOnly_;\n};\n\n\n/**\n * Checks if this Uri has been marked as read only, and if so, throws an error.\n * This should be called whenever any modifying function is called.\n */\ngoog.Uri.prototype.enforceReadOnly = function() {\n  if (this.isReadOnly_) {\n    throw new Error('Tried to modify a read-only Uri');\n  }\n};\n\n\n/**\n * Sets whether to ignore case.\n * NOTE: If there are already key/value pairs in the QueryData, and\n * ignoreCase_ is set to false, the keys will all be lower-cased.\n * @param {boolean} ignoreCase whether this goog.Uri should ignore case.\n * @return {!goog.Uri} Reference to this Uri object.\n */\ngoog.Uri.prototype.setIgnoreCase = function(ignoreCase) {\n  this.ignoreCase_ = ignoreCase;\n  if (this.queryData_) {\n    this.queryData_.setIgnoreCase(ignoreCase);\n  }\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether to ignore case.\n */\ngoog.Uri.prototype.getIgnoreCase = function() {\n  return this.ignoreCase_;\n};\n\n\n//==============================================================================\n// Static members\n//==============================================================================\n\n\n/**\n * Creates a uri from the string form.  Basically an alias of new goog.Uri().\n * If a Uri object is passed to parse then it will return a clone of the object.\n *\n * @throws URIError If parsing the URI is malformed. The passed URI components\n *     should all be parseable by decodeURIComponent.\n * @param {*} uri Raw URI string or instance of Uri\n *     object.\n * @param {boolean=} opt_ignoreCase Whether to ignore the case of parameter\n * names in #getParameterValue.\n * @return {!goog.Uri} The new URI object.\n */\ngoog.Uri.parse = function(uri, opt_ignoreCase) {\n  return uri instanceof goog.Uri ? uri.clone() :\n                                   new goog.Uri(uri, opt_ignoreCase);\n};\n\n\n/**\n * Creates a new goog.Uri object from unencoded parts.\n *\n * @param {?string=} opt_scheme Scheme/protocol or full URI to parse.\n * @param {?string=} opt_userInfo username:password.\n * @param {?string=} opt_domain www.google.com.\n * @param {?number=} opt_port 9830.\n * @param {?string=} opt_path /some/path/to/a/file.html.\n * @param {string|goog.Uri.QueryData=} opt_query a=1&b=2.\n * @param {?string=} opt_fragment The fragment without the #.\n * @param {boolean=} opt_ignoreCase Whether to ignore parameter name case in\n *     #getParameterValue.\n *\n * @return {!goog.Uri} The new URI object.\n */\ngoog.Uri.create = function(\n    opt_scheme, opt_userInfo, opt_domain, opt_port, opt_path, opt_query,\n    opt_fragment, opt_ignoreCase) {\n\n  var uri = new goog.Uri(null, opt_ignoreCase);\n\n  // Only set the parts if they are defined and not empty strings.\n  opt_scheme && uri.setScheme(opt_scheme);\n  opt_userInfo && uri.setUserInfo(opt_userInfo);\n  opt_domain && uri.setDomain(opt_domain);\n  opt_port && uri.setPort(opt_port);\n  opt_path && uri.setPath(opt_path);\n  opt_query && uri.setQueryData(opt_query);\n  opt_fragment && uri.setFragment(opt_fragment);\n\n  return uri;\n};\n\n\n/**\n * Resolves a relative Uri against a base Uri, accepting both strings and\n * Uri objects.\n *\n * @param {*} base Base Uri.\n * @param {*} rel Relative Uri.\n * @return {!goog.Uri} Resolved uri.\n */\ngoog.Uri.resolve = function(base, rel) {\n  if (!(base instanceof goog.Uri)) {\n    base = goog.Uri.parse(base);\n  }\n\n  if (!(rel instanceof goog.Uri)) {\n    rel = goog.Uri.parse(rel);\n  }\n\n  return base.resolve(rel);\n};\n\n\n/**\n * Removes dot segments in given path component, as described in\n * RFC 3986, section 5.2.4.\n *\n * @param {string} path A non-empty path component.\n * @return {string} Path component with removed dot segments.\n */\ngoog.Uri.removeDotSegments = function(path) {\n  if (path == '..' || path == '.') {\n    return '';\n\n  } else if (\n      !goog.string.contains(path, './') && !goog.string.contains(path, '/.')) {\n    // This optimization detects uris which do not contain dot-segments,\n    // and as a consequence do not require any processing.\n    return path;\n\n  } else {\n    var leadingSlash = goog.string.startsWith(path, '/');\n    var segments = path.split('/');\n    var out = [];\n\n    for (var pos = 0; pos < segments.length;) {\n      var segment = segments[pos++];\n\n      if (segment == '.') {\n        if (leadingSlash && pos == segments.length) {\n          out.push('');\n        }\n      } else if (segment == '..') {\n        if (out.length > 1 || out.length == 1 && out[0] != '') {\n          out.pop();\n        }\n        if (leadingSlash && pos == segments.length) {\n          out.push('');\n        }\n      } else {\n        out.push(segment);\n        leadingSlash = true;\n      }\n    }\n\n    return out.join('/');\n  }\n};\n\n\n/**\n * Decodes a value or returns the empty string if it isn't defined or empty.\n * @throws URIError If decodeURIComponent fails to decode val.\n * @param {string|undefined} val Value to decode.\n * @param {boolean=} opt_preserveReserved If true, restricted characters will\n *     not be decoded.\n * @return {string} Decoded value.\n * @private\n */\ngoog.Uri.decodeOrEmpty_ = function(val, opt_preserveReserved) {\n  // Don't use UrlDecode() here because val is not a query parameter.\n  if (!val) {\n    return '';\n  }\n\n  // decodeURI has the same output for '%2f' and '%252f'. We double encode %25\n  // so that we can distinguish between the 2 inputs. This is later undone by\n  // removeDoubleEncoding_.\n  return opt_preserveReserved ? decodeURI(val.replace(/%25/g, '%2525')) :\n                                decodeURIComponent(val);\n};\n\n\n/**\n * If unescapedPart is non null, then escapes any characters in it that aren't\n * valid characters in a url and also escapes any special characters that\n * appear in extra.\n *\n * @param {*} unescapedPart The string to encode.\n * @param {RegExp} extra A character set of characters in [\\01-\\177].\n * @param {boolean=} opt_removeDoubleEncoding If true, remove double percent\n *     encoding.\n * @return {?string} null iff unescapedPart == null.\n * @private\n */\ngoog.Uri.encodeSpecialChars_ = function(\n    unescapedPart, extra, opt_removeDoubleEncoding) {\n  if (typeof unescapedPart === 'string') {\n    var encoded = encodeURI(unescapedPart).replace(extra, goog.Uri.encodeChar_);\n    if (opt_removeDoubleEncoding) {\n      // encodeURI double-escapes %XX sequences used to represent restricted\n      // characters in some URI components, remove the double escaping here.\n      encoded = goog.Uri.removeDoubleEncoding_(encoded);\n    }\n    return encoded;\n  }\n  return null;\n};\n\n\n/**\n * Converts a character in [\\01-\\177] to its unicode character equivalent.\n * @param {string} ch One character string.\n * @return {string} Encoded string.\n * @private\n */\ngoog.Uri.encodeChar_ = function(ch) {\n  var n = ch.charCodeAt(0);\n  return '%' + ((n >> 4) & 0xf).toString(16) + (n & 0xf).toString(16);\n};\n\n\n/**\n * Removes double percent-encoding from a string.\n * @param  {string} doubleEncodedString String\n * @return {string} String with double encoding removed.\n * @private\n */\ngoog.Uri.removeDoubleEncoding_ = function(doubleEncodedString) {\n  return doubleEncodedString.replace(/%25([0-9a-fA-F]{2})/g, '%$1');\n};\n\n\n/**\n * Regular expression for characters that are disallowed in the scheme or\n * userInfo part of the URI.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInSchemeOrUserInfo_ = /[#\\/\\?@]/g;\n\n\n/**\n * Regular expression for characters that are disallowed in a relative path.\n * Colon is included due to RFC 3986 3.3.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInRelativePath_ = /[\\#\\?:]/g;\n\n\n/**\n * Regular expression for characters that are disallowed in an absolute path.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInAbsolutePath_ = /[\\#\\?]/g;\n\n\n/**\n * Regular expression for characters that are disallowed in the query.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInQuery_ = /[\\#\\?@]/g;\n\n\n/**\n * Regular expression for characters that are disallowed in the fragment.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInFragment_ = /#/g;\n\n\n/**\n * Checks whether two URIs have the same domain.\n * @param {string} uri1String First URI string.\n * @param {string} uri2String Second URI string.\n * @return {boolean} true if the two URIs have the same domain; false otherwise.\n */\ngoog.Uri.haveSameDomain = function(uri1String, uri2String) {\n  // Differs from goog.uri.utils.haveSameDomain, since this ignores scheme.\n  // TODO(gboyer): Have this just call goog.uri.util.haveSameDomain.\n  var pieces1 = goog.uri.utils.split(uri1String);\n  var pieces2 = goog.uri.utils.split(uri2String);\n  return pieces1[goog.uri.utils.ComponentIndex.DOMAIN] ==\n      pieces2[goog.uri.utils.ComponentIndex.DOMAIN] &&\n      pieces1[goog.uri.utils.ComponentIndex.PORT] ==\n      pieces2[goog.uri.utils.ComponentIndex.PORT];\n};\n\n\n\n/**\n * Class used to represent URI query parameters.  It is essentially a hash of\n * name-value pairs, though a name can be present more than once.\n *\n * Has the same interface as the collections in goog.structs.\n *\n * @param {?string=} opt_query Optional encoded query string to parse into\n *     the object.\n * @param {goog.Uri=} opt_uri Optional uri object that should have its\n *     cache invalidated when this object updates. Deprecated -- this\n *     is no longer required.\n * @param {boolean=} opt_ignoreCase If true, ignore the case of the parameter\n *     name in #get.\n * @constructor\n * @struct\n * @final\n */\ngoog.Uri.QueryData = function(opt_query, opt_uri, opt_ignoreCase) {\n  /**\n   * The map containing name/value or name/array-of-values pairs.\n   * May be null if it requires parsing from the query string.\n   *\n   * We need to use a Map because we cannot guarantee that the key names will\n   * not be problematic for IE.\n   *\n   * @private {?goog.structs.Map<string, !Array<*>>}\n   */\n  this.keyMap_ = null;\n\n  /**\n   * The number of params, or null if it requires computing.\n   * @private {?number}\n   */\n  this.count_ = null;\n\n  /**\n   * Encoded query string, or null if it requires computing from the key map.\n   * @private {?string}\n   */\n  this.encodedQuery_ = opt_query || null;\n\n  /**\n   * If true, ignore the case of the parameter name in #get.\n   * @private {boolean}\n   */\n  this.ignoreCase_ = !!opt_ignoreCase;\n};\n\n\n/**\n * If the underlying key map is not yet initialized, it parses the\n * query string and fills the map with parsed data.\n * @private\n */\ngoog.Uri.QueryData.prototype.ensureKeyMapInitialized_ = function() {\n  if (!this.keyMap_) {\n    this.keyMap_ = new goog.structs.Map();\n    this.count_ = 0;\n    if (this.encodedQuery_) {\n      var self = this;\n      goog.uri.utils.parseQueryData(this.encodedQuery_, function(name, value) {\n        self.add(goog.string.urlDecode(name), value);\n      });\n    }\n  }\n};\n\n\n/**\n * Creates a new query data instance from a map of names and values.\n *\n * @param {!goog.structs.Map<string, ?>|!Object} map Map of string parameter\n *     names to parameter value. If parameter value is an array, it is\n *     treated as if the key maps to each individual value in the\n *     array.\n * @param {goog.Uri=} opt_uri URI object that should have its cache\n *     invalidated when this object updates.\n * @param {boolean=} opt_ignoreCase If true, ignore the case of the parameter\n *     name in #get.\n * @return {!goog.Uri.QueryData} The populated query data instance.\n */\ngoog.Uri.QueryData.createFromMap = function(map, opt_uri, opt_ignoreCase) {\n  var keys = goog.structs.getKeys(map);\n  if (typeof keys == 'undefined') {\n    throw new Error('Keys are undefined');\n  }\n\n  var queryData = new goog.Uri.QueryData(null, null, opt_ignoreCase);\n  var values = goog.structs.getValues(map);\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = values[i];\n    if (!goog.isArray(value)) {\n      queryData.add(key, value);\n    } else {\n      queryData.setValues(key, value);\n    }\n  }\n  return queryData;\n};\n\n\n/**\n * Creates a new query data instance from parallel arrays of parameter names\n * and values. Allows for duplicate parameter names. Throws an error if the\n * lengths of the arrays differ.\n *\n * @param {!Array<string>} keys Parameter names.\n * @param {!Array<?>} values Parameter values.\n * @param {goog.Uri=} opt_uri URI object that should have its cache\n *     invalidated when this object updates.\n * @param {boolean=} opt_ignoreCase If true, ignore the case of the parameter\n *     name in #get.\n * @return {!goog.Uri.QueryData} The populated query data instance.\n */\ngoog.Uri.QueryData.createFromKeysValues = function(\n    keys, values, opt_uri, opt_ignoreCase) {\n  if (keys.length != values.length) {\n    throw new Error('Mismatched lengths for keys/values');\n  }\n  var queryData = new goog.Uri.QueryData(null, null, opt_ignoreCase);\n  for (var i = 0; i < keys.length; i++) {\n    queryData.add(keys[i], values[i]);\n  }\n  return queryData;\n};\n\n\n/**\n * @return {?number} The number of parameters.\n */\ngoog.Uri.QueryData.prototype.getCount = function() {\n  this.ensureKeyMapInitialized_();\n  return this.count_;\n};\n\n\n/**\n * Adds a key value pair.\n * @param {string} key Name.\n * @param {*} value Value.\n * @return {!goog.Uri.QueryData} Instance of this object.\n */\ngoog.Uri.QueryData.prototype.add = function(key, value) {\n  this.ensureKeyMapInitialized_();\n  this.invalidateCache_();\n\n  key = this.getKeyName_(key);\n  var values = this.keyMap_.get(key);\n  if (!values) {\n    this.keyMap_.set(key, (values = []));\n  }\n  values.push(value);\n  this.count_ = goog.asserts.assertNumber(this.count_) + 1;\n  return this;\n};\n\n\n/**\n * Removes all the params with the given key.\n * @param {string} key Name.\n * @return {boolean} Whether any parameter was removed.\n */\ngoog.Uri.QueryData.prototype.remove = function(key) {\n  this.ensureKeyMapInitialized_();\n\n  key = this.getKeyName_(key);\n  if (this.keyMap_.containsKey(key)) {\n    this.invalidateCache_();\n\n    // Decrement parameter count.\n    this.count_ =\n        goog.asserts.assertNumber(this.count_) - this.keyMap_.get(key).length;\n    return this.keyMap_.remove(key);\n  }\n  return false;\n};\n\n\n/**\n * Clears the parameters.\n */\ngoog.Uri.QueryData.prototype.clear = function() {\n  this.invalidateCache_();\n  this.keyMap_ = null;\n  this.count_ = 0;\n};\n\n\n/**\n * @return {boolean} Whether we have any parameters.\n */\ngoog.Uri.QueryData.prototype.isEmpty = function() {\n  this.ensureKeyMapInitialized_();\n  return this.count_ == 0;\n};\n\n\n/**\n * Whether there is a parameter with the given name\n * @param {string} key The parameter name to check for.\n * @return {boolean} Whether there is a parameter with the given name.\n */\ngoog.Uri.QueryData.prototype.containsKey = function(key) {\n  this.ensureKeyMapInitialized_();\n  key = this.getKeyName_(key);\n  return this.keyMap_.containsKey(key);\n};\n\n\n/**\n * Whether there is a parameter with the given value.\n * @param {*} value The value to check for.\n * @return {boolean} Whether there is a parameter with the given value.\n */\ngoog.Uri.QueryData.prototype.containsValue = function(value) {\n  // NOTE(arv): This solution goes through all the params even if it was the\n  // first param. We can get around this by not reusing code or by switching to\n  // iterators.\n  var vals = this.getValues();\n  return goog.array.contains(vals, value);\n};\n\n\n/**\n * Runs a callback on every key-value pair in the map, including duplicate keys.\n * This won't maintain original order when duplicate keys are interspersed (like\n * getKeys() / getValues()).\n * @param {function(this:SCOPE, ?, string, !goog.Uri.QueryData)} f\n * @param {SCOPE=} opt_scope The value of \"this\" inside f.\n * @template SCOPE\n */\ngoog.Uri.QueryData.prototype.forEach = function(f, opt_scope) {\n  this.ensureKeyMapInitialized_();\n  this.keyMap_.forEach(function(values, key) {\n    goog.array.forEach(values, function(value) {\n      f.call(opt_scope, value, key, this);\n    }, this);\n  }, this);\n};\n\n\n/**\n * Returns all the keys of the parameters. If a key is used multiple times\n * it will be included multiple times in the returned array\n * @return {!Array<string>} All the keys of the parameters.\n */\ngoog.Uri.QueryData.prototype.getKeys = function() {\n  this.ensureKeyMapInitialized_();\n  // We need to get the values to know how many keys to add.\n  var vals = this.keyMap_.getValues();\n  var keys = this.keyMap_.getKeys();\n  var rv = [];\n  for (var i = 0; i < keys.length; i++) {\n    var val = vals[i];\n    for (var j = 0; j < val.length; j++) {\n      rv.push(keys[i]);\n    }\n  }\n  return rv;\n};\n\n\n/**\n * Returns all the values of the parameters with the given name. If the query\n * data has no such key this will return an empty array. If no key is given\n * all values wil be returned.\n * @param {string=} opt_key The name of the parameter to get the values for.\n * @return {!Array<?>} All the values of the parameters with the given name.\n */\ngoog.Uri.QueryData.prototype.getValues = function(opt_key) {\n  this.ensureKeyMapInitialized_();\n  var rv = [];\n  if (typeof opt_key === 'string') {\n    if (this.containsKey(opt_key)) {\n      rv = goog.array.concat(rv, this.keyMap_.get(this.getKeyName_(opt_key)));\n    }\n  } else {\n    // Return all values.\n    var values = this.keyMap_.getValues();\n    for (var i = 0; i < values.length; i++) {\n      rv = goog.array.concat(rv, values[i]);\n    }\n  }\n  return rv;\n};\n\n\n/**\n * Sets a key value pair and removes all other keys with the same value.\n *\n * @param {string} key Name.\n * @param {*} value Value.\n * @return {!goog.Uri.QueryData} Instance of this object.\n */\ngoog.Uri.QueryData.prototype.set = function(key, value) {\n  this.ensureKeyMapInitialized_();\n  this.invalidateCache_();\n\n  // TODO(chrishenry): This could be better written as\n  // this.remove(key), this.add(key, value), but that would reorder\n  // the key (since the key is first removed and then added at the\n  // end) and we would have to fix unit tests that depend on key\n  // ordering.\n  key = this.getKeyName_(key);\n  if (this.containsKey(key)) {\n    this.count_ =\n        goog.asserts.assertNumber(this.count_) - this.keyMap_.get(key).length;\n  }\n  this.keyMap_.set(key, [value]);\n  this.count_ = goog.asserts.assertNumber(this.count_) + 1;\n  return this;\n};\n\n\n/**\n * Returns the first value associated with the key. If the query data has no\n * such key this will return undefined or the optional default.\n * @param {string} key The name of the parameter to get the value for.\n * @param {*=} opt_default The default value to return if the query data\n *     has no such key.\n * @return {*} The first string value associated with the key, or opt_default\n *     if there's no value.\n */\ngoog.Uri.QueryData.prototype.get = function(key, opt_default) {\n  if (!key) {\n    return opt_default;\n  }\n  var values = this.getValues(key);\n  return values.length > 0 ? String(values[0]) : opt_default;\n};\n\n\n/**\n * Sets the values for a key. If the key already exists, this will\n * override all of the existing values that correspond to the key.\n * @param {string} key The key to set values for.\n * @param {!Array<?>} values The values to set.\n */\ngoog.Uri.QueryData.prototype.setValues = function(key, values) {\n  this.remove(key);\n\n  if (values.length > 0) {\n    this.invalidateCache_();\n    this.keyMap_.set(this.getKeyName_(key), goog.array.clone(values));\n    this.count_ = goog.asserts.assertNumber(this.count_) + values.length;\n  }\n};\n\n\n/**\n * @return {string} Encoded query string.\n * @override\n */\ngoog.Uri.QueryData.prototype.toString = function() {\n  if (this.encodedQuery_) {\n    return this.encodedQuery_;\n  }\n\n  if (!this.keyMap_) {\n    return '';\n  }\n\n  var sb = [];\n\n  // In the past, we use this.getKeys() and this.getVals(), but that\n  // generates a lot of allocations as compared to simply iterating\n  // over the keys.\n  var keys = this.keyMap_.getKeys();\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var encodedKey = goog.string.urlEncode(key);\n    var val = this.getValues(key);\n    for (var j = 0; j < val.length; j++) {\n      var param = encodedKey;\n      // Ensure that null and undefined are encoded into the url as\n      // literal strings.\n      if (val[j] !== '') {\n        param += '=' + goog.string.urlEncode(val[j]);\n      }\n      sb.push(param);\n    }\n  }\n\n  return this.encodedQuery_ = sb.join('&');\n};\n\n\n/**\n * @throws URIError If URI is malformed (that is, if decodeURIComponent fails on\n *     any of the URI components).\n * @return {string} Decoded query string.\n */\ngoog.Uri.QueryData.prototype.toDecodedString = function() {\n  return goog.Uri.decodeOrEmpty_(this.toString());\n};\n\n\n/**\n * Invalidate the cache.\n * @private\n */\ngoog.Uri.QueryData.prototype.invalidateCache_ = function() {\n  this.encodedQuery_ = null;\n};\n\n\n/**\n * Removes all keys that are not in the provided list. (Modifies this object.)\n * @param {Array<string>} keys The desired keys.\n * @return {!goog.Uri.QueryData} a reference to this object.\n */\ngoog.Uri.QueryData.prototype.filterKeys = function(keys) {\n  this.ensureKeyMapInitialized_();\n  this.keyMap_.forEach(function(value, key) {\n    if (!goog.array.contains(keys, key)) {\n      this.remove(key);\n    }\n  }, this);\n  return this;\n};\n\n\n/**\n * Clone the query data instance.\n * @return {!goog.Uri.QueryData} New instance of the QueryData object.\n */\ngoog.Uri.QueryData.prototype.clone = function() {\n  var rv = new goog.Uri.QueryData();\n  rv.encodedQuery_ = this.encodedQuery_;\n  if (this.keyMap_) {\n    rv.keyMap_ = this.keyMap_.clone();\n    rv.count_ = this.count_;\n  }\n  return rv;\n};\n\n\n/**\n * Helper function to get the key name from a JavaScript object. Converts\n * the object to a string, and to lower case if necessary.\n * @private\n * @param {*} arg The object to get a key name from.\n * @return {string} valid key name which can be looked up in #keyMap_.\n */\ngoog.Uri.QueryData.prototype.getKeyName_ = function(arg) {\n  var keyName = String(arg);\n  if (this.ignoreCase_) {\n    keyName = keyName.toLowerCase();\n  }\n  return keyName;\n};\n\n\n/**\n * Ignore case in parameter names.\n * NOTE: If there are already key/value pairs in the QueryData, and\n * ignoreCase_ is set to false, the keys will all be lower-cased.\n * @param {boolean} ignoreCase whether this goog.Uri should ignore case.\n */\ngoog.Uri.QueryData.prototype.setIgnoreCase = function(ignoreCase) {\n  var resetKeys = ignoreCase && !this.ignoreCase_;\n  if (resetKeys) {\n    this.ensureKeyMapInitialized_();\n    this.invalidateCache_();\n    this.keyMap_.forEach(function(value, key) {\n      var lowerCase = key.toLowerCase();\n      if (key != lowerCase) {\n        this.remove(key);\n        this.setValues(lowerCase, value);\n      }\n    }, this);\n  }\n  this.ignoreCase_ = ignoreCase;\n};\n\n\n/**\n * Extends a query data object with another query data or map like object. This\n * operates 'in-place', it does not create a new QueryData object.\n *\n * @param {...(?goog.Uri.QueryData|?goog.structs.Map<?, ?>|?Object)} var_args\n *     The object from which key value pairs will be copied. Note: does not\n *     accept null.\n * @suppress {deprecated} Use deprecated goog.structs.forEach to allow different\n * types of parameters.\n */\ngoog.Uri.QueryData.prototype.extend = function(var_args) {\n  for (var i = 0; i < arguments.length; i++) {\n    var data = arguments[i];\n    goog.structs.forEach(\n        data, function(value, key) { this.add(key, value); }, this);\n  }\n};\n"],
"names":["goog","provide","require","Uri","goog.Uri","opt_uri","opt_ignoreCase","scheme_","userInfo_","domain_","port_","path_","fragment_","isReadOnly_","ignoreCase_","queryData_","m","undefined","getIgnoreCase","setScheme","getScheme","setUserInfo","getUserInfo","setDomain","getDomain","setPort","getPort","setPath","getPath","setQueryData","getQueryData","clone","setFragment","getFragment","uri","utils","split","String","ComponentIndex","SCHEME","USER_INFO","DOMAIN","PORT","PATH","QUERY_DATA","FRAGMENT","QueryData","RANDOM_PARAM","StandardQueryParam","RANDOM","prototype","toString","goog.Uri.prototype.toString","out","scheme","push","encodeSpecialChars_","reDisallowedInSchemeOrUserInfo_","domain","userInfo","removeDoubleEncoding_","string","urlEncode","port","path","hasDomain","charAt","reDisallowedInAbsolutePath_","reDisallowedInRelativePath_","query","getEncodedQuery","fragment","reDisallowedInFragment_","join","resolve","goog.Uri.prototype.resolve","relativeUri","absoluteUri","overridden","hasScheme","hasUserInfo","hasPort","hasPath","lastSlashIndex","lastIndexOf","substr","removeDotSegments","hasQuery","hasFragment","goog.Uri.prototype.clone","goog.Uri.prototype.getScheme","goog.Uri.prototype.setScheme","newScheme","opt_decode","enforceReadOnly","decodeOrEmpty_","replace","goog.Uri.prototype.hasScheme","goog.Uri.prototype.getUserInfo","goog.Uri.prototype.setUserInfo","newUserInfo","goog.Uri.prototype.hasUserInfo","goog.Uri.prototype.getDomain","goog.Uri.prototype.setDomain","newDomain","goog.Uri.prototype.hasDomain","goog.Uri.prototype.getPort","goog.Uri.prototype.setPort","newPort","Number","isNaN","Error","goog.Uri.prototype.hasPort","goog.Uri.prototype.getPath","goog.Uri.prototype.setPath","newPath","goog.Uri.prototype.hasPath","goog.Uri.prototype.hasQuery","goog.Uri.prototype.setQueryData","queryData","setIgnoreCase","reDisallowedInQuery_","setQuery","goog.Uri.prototype.setQuery","newQuery","goog.Uri.prototype.getEncodedQuery","getDecodedQuery","goog.Uri.prototype.getDecodedQuery","toDecodedString","goog.Uri.prototype.getQueryData","getQuery","goog.Uri.prototype.getQuery","setParameterValue","goog.Uri.prototype.setParameterValue","key","value","set","setParameterValues","goog.Uri.prototype.setParameterValues","values","isArray","setValues","getParameterValues","goog.Uri.prototype.getParameterValues","name","getValues","getParameterValue","goog.Uri.prototype.getParameterValue","paramName","get","goog.Uri.prototype.getFragment","goog.Uri.prototype.setFragment","newFragment","goog.Uri.prototype.hasFragment","hasSameDomainAs","goog.Uri.prototype.hasSameDomainAs","uri2","makeUnique","goog.Uri.prototype.makeUnique","getRandomString","removeParameter","goog.Uri.prototype.removeParameter","remove","setReadOnly","goog.Uri.prototype.setReadOnly","isReadOnly","goog.Uri.prototype.isReadOnly","goog.Uri.prototype.enforceReadOnly","goog.Uri.prototype.setIgnoreCase","ignoreCase","goog.Uri.prototype.getIgnoreCase","parse","goog.Uri.parse","create","goog.Uri.create","opt_scheme","opt_userInfo","opt_domain","opt_port","opt_path","opt_query","opt_fragment","goog.Uri.resolve","base","rel","goog.Uri.removeDotSegments","contains","leadingSlash","startsWith","segments","pos","length","segment","pop","goog.Uri.decodeOrEmpty_","val","opt_preserveReserved","decodeURI","decodeURIComponent","goog.Uri.encodeSpecialChars_","unescapedPart","extra","opt_removeDoubleEncoding","encoded","encodeURI","encodeChar_","goog.Uri.encodeChar_","ch","n","charCodeAt","goog.Uri.removeDoubleEncoding_","doubleEncodedString","haveSameDomain","goog.Uri.haveSameDomain","uri1String","uri2String","pieces1","pieces2","goog.Uri.QueryData","keyMap_","count_","encodedQuery_","ensureKeyMapInitialized_","goog.Uri.QueryData.prototype.ensureKeyMapInitialized_","structs","Map","self","parseQueryData","add","urlDecode","createFromMap","goog.Uri.QueryData.createFromMap","map","keys","getKeys","i","createFromKeysValues","goog.Uri.QueryData.createFromKeysValues","getCount","goog.Uri.QueryData.prototype.getCount","goog.Uri.QueryData.prototype.add","invalidateCache_","getKeyName_","asserts","assertNumber","goog.Uri.QueryData.prototype.remove","containsKey","clear","goog.Uri.QueryData.prototype.clear","isEmpty","goog.Uri.QueryData.prototype.isEmpty","goog.Uri.QueryData.prototype.containsKey","containsValue","goog.Uri.QueryData.prototype.containsValue","vals","array","forEach","goog.Uri.QueryData.prototype.forEach","f","opt_scope","call","goog.Uri.QueryData.prototype.getKeys","rv","j","goog.Uri.QueryData.prototype.getValues","opt_key","concat","goog.Uri.QueryData.prototype.set","goog.Uri.QueryData.prototype.get","opt_default","goog.Uri.QueryData.prototype.setValues","goog.Uri.QueryData.prototype.toString","sb","encodedKey","param","goog.Uri.QueryData.prototype.toDecodedString","goog.Uri.QueryData.prototype.invalidateCache_","filterKeys","goog.Uri.QueryData.prototype.filterKeys","goog.Uri.QueryData.prototype.clone","goog.Uri.QueryData.prototype.getKeyName_","arg","keyName","toLowerCase","goog.Uri.QueryData.prototype.setIgnoreCase","resetKeys","lowerCase","extend","goog.Uri.QueryData.prototype.extend","var_args","arguments","data"]
}
